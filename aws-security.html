<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS Security | SIEM Consultant Portfolio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <button class="mobile-menu-toggle" aria-label="Toggle navigation"><span></span></button>
    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" style="text-decoration: none; color: inherit;">
                    <div class="sidebar-logo"><div class="sidebar-logo-icon">âš¡</div>SIEM Consultant</div>
                </a>
                <div class="sidebar-subtitle">Knowledge Portfolio</div>
            </div>
                        <nav class="sidebar-nav">
                <!-- Foundation -->
                <div class="nav-section">
                    <div class="nav-section-title">Foundation</div>
                    <a href="index.html" class="nav-item">Home</a>
                    <a href="approach.html" class="nav-item">Consulting Approach</a>
                    <a href="deliverables.html" class="nav-item">Project Deliverables</a>
                    <a href="experience.html" class="nav-item">Experience</a>
                </div>
                
                <!-- SIEM Fundamentals -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Fundamentals</div>
                    <a href="what-is-siem.html" class="nav-item">What is SIEM?</a>
                    <a href="siem-architecture.html" class="nav-item">SIEM Architecture</a>
                    <a href="siem-data-flow.html" class="nav-item">SIEM Data Flow</a>
                    <a href="platform-comparison.html" class="nav-item">Platform Comparison</a>
                    <a href="siem-metrics.html" class="nav-item">SIEM Metrics</a>
                    <a href="siem-health.html" class="nav-item">SIEM Health</a>
                    <a href="siem-rfp.html" class="nav-item">SIEM RFP Guide</a>
                    <a href="security-data-lake.html" class="nav-item">Security Data Lake</a>
                </div>
                
                <!-- SIEM Platforms -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Platforms</div>
                    <a href="splunk-overview.html" class="nav-item">Splunk Overview</a>
                    <a href="splunk-cloud.html" class="nav-item">Splunk Cloud</a>
                    <a href="splunk-hybrid.html" class="nav-item">Splunk Hybrid</a>
                    <a href="sentinel-overview.html" class="nav-item">Microsoft Sentinel</a>
                </div>
                
                <!-- Log Sources -->
                <div class="nav-section">
                    <div class="nav-section-title">Log Sources</div>
                    <a href="log-sources-overview.html" class="nav-item">Log Sources Overview</a>
                    <a href="windows-logs.html" class="nav-item">Windows Logs</a>
                    <a href="linux-logs.html" class="nav-item">Linux Logs</a>
                    <a href="network-logs.html" class="nav-item">Network Logs</a>
                    <a href="cloud-logs.html" class="nav-item">Cloud Logs</a>
                    <a href="endpoint-logs.html" class="nav-item">Endpoint Logs</a>
                    <a href="identity-logs.html" class="nav-item">Identity Logs</a>
                    <a href="application-logs.html" class="nav-item">Application Logs</a>
                </div>
                
                <!-- Log Engineering -->
                <div class="nav-section">
                    <div class="nav-section-title">Log Engineering</div>
                    <a href="log-pipeline.html" class="nav-item">Log Pipeline</a>
                    <a href="log-parsing.html" class="nav-item">Log Parsing</a>
                    <a href="log-retention.html" class="nav-item">Log Retention</a>
                </div>
                
                <!-- SIEM Migrations -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Migrations</div>
                    <a href="migration-methodology.html" class="nav-item">Migration Methodology</a>
                    <a href="discovery-assessment.html" class="nav-item">Discovery & Assessment</a>
                    <a href="log-migration.html" class="nav-item">Log Migration</a>
                    <a href="detection-migration.html" class="nav-item">Detection Migration</a>
                    <a href="query-translation.html" class="nav-item">Query Translation</a>
                </div>
                
                <!-- Detection Engineering -->
                <div class="nav-section">
                    <div class="nav-section-title">Detection Engineering</div>
                    <a href="detection-fundamentals.html" class="nav-item">Detection Fundamentals</a>
                    <a href="use-case-development.html" class="nav-item">Use Case Development</a>
                    <a href="tuning-methodology.html" class="nav-item">Tuning Methodology</a>
                    <a href="sigma-rules.html" class="nav-item">Sigma Rules</a>
                    <a href="alert-enrichment.html" class="nav-item">Alert Enrichment</a>
                    <a href="alert-fatigue.html" class="nav-item">Alert Fatigue</a>
                </div>
                
                <!-- Threat Detection -->
                <div class="nav-section">
                    <div class="nav-section-title">Threat Detection</div>
                    <a href="mitre-attack-intro.html" class="nav-item">MITRE ATT&CK</a>
                    <a href="threat-modeling.html" class="nav-item">Threat Modeling</a>
                    <a href="threat-intelligence.html" class="nav-item">Threat Intelligence</a>
                    <a href="threat-hunting.html" class="nav-item">Threat Hunting</a>
                    <a href="ueba-analytics.html" class="nav-item">UEBA Analytics</a>
                </div>
                
                <!-- Query Languages -->
                <div class="nav-section">
                    <div class="nav-section-title">Query Languages</div>
                    <a href="spl-fundamentals.html" class="nav-item">SPL Fundamentals</a>
                    <a href="kql-fundamentals.html" class="nav-item">KQL Fundamentals</a>
                </div>
                
                <!-- Windows Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Windows Security</div>
                    <a href="sysmon-config.html" class="nav-item">Sysmon Configuration</a>
                    <a href="windows-attack-techniques.html" class="nav-item">Windows Attacks</a>
                    <a href="windows-hardening.html" class="nav-item">Windows Hardening</a>
                    <a href="powershell-security.html" class="nav-item">PowerShell Security</a>
                </div>
                
                <!-- Cloud Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Cloud Security</div>
                    <a href="cloud-security-monitoring.html" class="nav-item">Cloud Monitoring</a>
                    <a href="azure-security.html" class="nav-item">Azure Security</a>
                    <a href="aws-security.html" class="nav-item active">AWS Security</a>
                    <a href="gcp-security.html" class="nav-item">GCP Security</a>
                    <a href="m365-security.html" class="nav-item">M365 Security</a>
                    <a href="container-security.html" class="nav-item">Container Security</a>
                </div>
                
                <!-- Network Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Network Security</div>
                    <a href="network-security-monitoring.html" class="nav-item">Network Monitoring</a>
                    <a href="dns-security.html" class="nav-item">DNS Security</a>
                    <a href="zero-trust.html" class="nav-item">Zero Trust</a>
                </div>
                
                <!-- Identity Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Identity Security</div>
                    <a href="identity-security.html" class="nav-item">Identity Security</a>
                    <a href="active-directory.html" class="nav-item">Active Directory</a>
                </div>
                
                <!-- Data Protection -->
                <div class="nav-section">
                    <div class="nav-section-title">Data Protection</div>
                    <a href="dlp-monitoring.html" class="nav-item">DLP Monitoring</a>
                    <a href="data-classification.html" class="nav-item">Data Classification</a>
                    <a href="data-exfiltration.html" class="nav-item">Data Exfiltration</a>
                    <a href="insider-threats.html" class="nav-item">Insider Threats</a>
                </div>
                
                <!-- Specific Threats -->
                <div class="nav-section">
                    <div class="nav-section-title">Threat Scenarios</div>
                    <a href="phishing-detection.html" class="nav-item">Phishing Detection</a>
                    <a href="ransomware-detection.html" class="nav-item">Ransomware Detection</a>
                    <a href="email-security.html" class="nav-item">Email Security</a>
                </div>
                
                <!-- SOC Operations -->
                <div class="nav-section">
                    <div class="nav-section-title">SOC Operations</div>
                    <a href="soc-operations.html" class="nav-item">SOC Operations</a>
                    <a href="incident-response.html" class="nav-item">Incident Response</a>
                    <a href="incident-metrics.html" class="nav-item">Incident Metrics</a>
                    <a href="case-management.html" class="nav-item">Case Management</a>
                    <a href="dashboard-design.html" class="nav-item">Dashboard Design</a>
                    <a href="runbook-development.html" class="nav-item">Runbook Development</a>
                </div>
                
                <!-- Automation -->
                <div class="nav-section">
                    <div class="nav-section-title">Automation</div>
                    <a href="soar-automation.html" class="nav-item">SOAR Automation</a>
                    <a href="security-playbooks.html" class="nav-item">Security Playbooks</a>
                    <a href="python-security.html" class="nav-item">Python for Security</a>
                </div>
                
                <!-- Integrations -->
                <div class="nav-section">
                    <div class="nav-section-title">Integrations</div>
                    <a href="edr-integration.html" class="nav-item">EDR Integration</a>
                    <a href="vulnerability-management.html" class="nav-item">Vulnerability Mgmt</a>
                    <a href="api-security.html" class="nav-item">API Security</a>
                </div>
                
                <!-- Operations -->
                <div class="nav-section">
                    <div class="nav-section-title">Operations</div>
                    <a href="performance-optimization.html" class="nav-item">Performance</a>
                    <a href="cost-optimization.html" class="nav-item">Cost Optimization</a>
                    <a href="compliance-governance.html" class="nav-item">Compliance</a>
                </div>
                
                <!-- Interview Prep -->
                <div class="nav-section">
                    <div class="nav-section-title">Interview Prep</div>
                    <a href="interview-strategy.html" class="nav-item">â­ Interview Strategy</a>
                    <a href="common-questions.html" class="nav-item">Common Questions</a>
                    <a href="interview-scenarios.html" class="nav-item">Scenarios</a>
                </div>
            </nav>
        </aside>
        <main class="main-content">
            <div class="content-wrapper">
                <nav class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="breadcrumb-separator">/</span>
                    <a href="cloud-security-monitoring.html">Cloud Security</a>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-current">AWS Security</span>
                </nav>

                <header class="page-header">
                    <h1 class="page-title">AWS Security Monitoring</h1>
                    <p class="page-subtitle">Amazon Web Services provides comprehensive security logging through CloudTrail, GuardDuty, and other services. Understanding AWS security primitives is essential for effective cloud security monitoring.</p>
                </header>

                <section class="content-section">
                    <h2>AWS Security Architecture</h2>
                    
                    <div class="diagram">
                        <div class="diagram-title">AWS Security Services</div>
                        <pre><code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        AWS SECURITY ECOSYSTEM                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        SIEM / SECURITY LAKE                          â”‚   â”‚
â”‚  â”‚           (Splunk, Sentinel, or AWS Security Lake)                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â–²              â–²              â–²              â–²                   â”‚
â”‚           â”‚              â”‚              â”‚              â”‚                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ CLOUDTRAIL  â”‚ â”‚ GUARDDUTY    â”‚ â”‚ VPC FLOW  â”‚ â”‚ CONFIG     â”‚            â”‚
â”‚  â”‚ (API Audit) â”‚ â”‚ (Detection)  â”‚ â”‚ LOGS      â”‚ â”‚ (Posture)  â”‚            â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
â”‚  â”‚ All API     â”‚ â”‚ ML-based     â”‚ â”‚ Network   â”‚ â”‚ Resource   â”‚            â”‚
â”‚  â”‚ calls       â”‚ â”‚ threat       â”‚ â”‚ traffic   â”‚ â”‚ config     â”‚            â”‚
â”‚  â”‚ Management  â”‚ â”‚ detection    â”‚ â”‚ metadata  â”‚ â”‚ changes    â”‚            â”‚
â”‚  â”‚ + Data      â”‚ â”‚ DNS logs     â”‚ â”‚           â”‚ â”‚ Compliance â”‚            â”‚
â”‚  â”‚ events      â”‚ â”‚ integrated   â”‚ â”‚           â”‚ â”‚            â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ IAM        â”‚ â”‚ S3 ACCESS    â”‚ â”‚ WAF       â”‚ â”‚ SECURITY   â”‚             â”‚
â”‚  â”‚ ACCESS     â”‚ â”‚ LOGS         â”‚ â”‚ LOGS      â”‚ â”‚ HUB        â”‚             â”‚
â”‚  â”‚ ANALYZER   â”‚ â”‚              â”‚ â”‚           â”‚ â”‚            â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>CloudTrail Monitoring</h2>
                    <p>CloudTrail logs all API activity in AWS. Key events to monitor:</p>
                    
                    <h3>Critical IAM Events</h3>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Event Name</th>
                                    <th>Description</th>
                                    <th>Security Significance</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>CreateUser</code></td>
                                    <td>New IAM user created</td>
                                    <td>Backdoor account creation</td>
                                </tr>
                                <tr>
                                    <td><code>CreateAccessKey</code></td>
                                    <td>New access key pair</td>
                                    <td>Persistence mechanism</td>
                                </tr>
                                <tr>
                                    <td><code>AttachUserPolicy</code></td>
                                    <td>Policy attached to user</td>
                                    <td>Privilege escalation</td>
                                </tr>
                                <tr>
                                    <td><code>PutUserPolicy</code></td>
                                    <td>Inline policy added</td>
                                    <td>Privilege escalation</td>
                                </tr>
                                <tr>
                                    <td><code>AssumeRole</code></td>
                                    <td>Role assumption</td>
                                    <td>Cross-account access, lateral movement</td>
                                </tr>
                                <tr>
                                    <td><code>ConsoleLogin</code></td>
                                    <td>AWS console login</td>
                                    <td>Interactive access</td>
                                </tr>
                                <tr>
                                    <td><code>GetSecretValue</code></td>
                                    <td>Secret retrieved</td>
                                    <td>Credential access</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">SPL: IAM Privilege Escalation</div>
                        <pre><code>index=aws sourcetype=aws:cloudtrail
eventName IN ("AttachUserPolicy", "AttachRolePolicy", "PutUserPolicy", 
              "PutRolePolicy", "CreatePolicyVersion", "SetDefaultPolicyVersion")
| stats count by eventName, userIdentity.arn, requestParameters.policyArn
| where requestParameters.policyArn="*AdministratorAccess*" 
     OR requestParameters.policyArn="*PowerUserAccess*"</code></pre>
                    </div>

                    <h3>Suspicious API Patterns</h3>
                    <div class="info-box tip">
                        <div class="info-box-title">SPL: Reconnaissance Activity</div>
                        <pre><code>index=aws sourcetype=aws:cloudtrail
eventName IN ("DescribeInstances", "DescribeSecurityGroups", "DescribeSubnets",
              "ListBuckets", "GetBucketAcl", "ListUsers", "ListRoles",
              "DescribeDBInstances", "ListSecrets")
| stats dc(eventName) as unique_api_calls, count as total_calls, 
        values(eventName) as apis by userIdentity.arn, sourceIPAddress
| where unique_api_calls > 5 AND total_calls > 20
| sort -total_calls</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">SPL: Root Account Usage</div>
                        <pre><code>index=aws sourcetype=aws:cloudtrail
userIdentity.type="Root"
| stats count by eventName, sourceIPAddress, userAgent
| sort -count

// Root account usage should be extremely rare!
// Alert on ANY root account activity</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>GuardDuty Integration</h2>
                    <p>GuardDuty provides ML-based threat detection. Key finding types:</p>
                    
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Finding Type</th>
                                    <th>Category</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>UnauthorizedAccess:IAMUser/ConsoleLogin</code></td>
                                    <td>IAM</td>
                                    <td>Suspicious console login</td>
                                </tr>
                                <tr>
                                    <td><code>UnauthorizedAccess:IAMUser/InstanceCredentialExfiltration</code></td>
                                    <td>IAM</td>
                                    <td>Instance creds used externally</td>
                                </tr>
                                <tr>
                                    <td><code>Recon:EC2/PortProbeUnprotectedPort</code></td>
                                    <td>Network</td>
                                    <td>Port scanning detected</td>
                                </tr>
                                <tr>
                                    <td><code>CryptoCurrency:EC2/BitcoinTool.B</code></td>
                                    <td>Malware</td>
                                    <td>Crypto mining activity</td>
                                </tr>
                                <tr>
                                    <td><code>Exfiltration:S3/MaliciousIPCaller</code></td>
                                    <td>Data</td>
                                    <td>S3 access from malicious IP</td>
                                </tr>
                                <tr>
                                    <td><code>Impact:EC2/PortSweep</code></td>
                                    <td>Attack</td>
                                    <td>Instance performing port sweep</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">SPL: GuardDuty High-Severity Findings</div>
                        <pre><code>index=aws sourcetype="aws:guardduty"
| where severity >= 7
| stats count by type, resource.instanceDetails.instanceId, 
        service.action.networkConnectionAction.remoteIpDetails.ipAddressV4
| sort -count</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>S3 Security Monitoring</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">SPL: S3 Bucket Policy Changes</div>
                        <pre><code>index=aws sourcetype=aws:cloudtrail
eventName IN ("PutBucketPolicy", "PutBucketAcl", "PutBucketPublicAccessBlock",
              "DeleteBucketPolicy", "PutObjectAcl")
| spath output=bucket path=requestParameters.bucketName
| stats count by eventName, bucket, userIdentity.arn, sourceIPAddress
| sort -count</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">SPL: Detect Public Bucket Creation</div>
                        <pre><code>index=aws sourcetype=aws:cloudtrail
eventName="PutBucketAcl"
| spath output=grants path=requestParameters.AccessControlPolicy.AccessControlList.Grant{}
| mvexpand grants
| search grants="*AllUsers*" OR grants="*AuthenticatedUsers*"
| table _time, userIdentity.arn, requestParameters.bucketName, grants</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">SPL: Large S3 Data Access</div>
                        <pre><code>index=aws sourcetype=aws:s3accesslogs
| stats sum(bytes_sent) as total_bytes, count as request_count 
        by bucket, remote_ip, requester
| eval total_gb = round(total_bytes/1024/1024/1024, 2)
| where total_gb > 10
| sort -total_gb</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>EC2 & Network Security</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">SPL: Security Group Opens</div>
                        <pre><code>index=aws sourcetype=aws:cloudtrail
eventName IN ("AuthorizeSecurityGroupIngress", "AuthorizeSecurityGroupEgress")
| spath output=fromPort path=requestParameters.ipPermissions.items{}.fromPort
| spath output=toPort path=requestParameters.ipPermissions.items{}.toPort
| spath output=cidr path=requestParameters.ipPermissions.items{}.ipRanges.items{}.cidrIp
| where cidr="0.0.0.0/0"
| table _time, userIdentity.arn, requestParameters.groupId, fromPort, toPort, cidr</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">SPL: VPC Flow Log Analysis</div>
                        <pre><code>index=aws sourcetype=aws:cloudwatchlogs:vpcflow
action=REJECT
| stats count by src_ip, dest_ip, dest_port
| sort -count
| head 20</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">SPL: EC2 Instance Metadata Access</div>
                        <pre><code>// Detect potential SSRF attempts via metadata service
index=aws sourcetype=aws:cloudtrail
eventSource="ec2.amazonaws.com"
| search userAgent="*169.254.169.254*" OR requestParameters="*169.254.169.254*"
| table _time, eventName, userIdentity.arn, sourceIPAddress, userAgent</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Cross-Account Activity</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">SPL: Cross-Account Role Assumptions</div>
                        <pre><code>index=aws sourcetype=aws:cloudtrail
eventName="AssumeRole"
| spath output=assumed_role path=requestParameters.roleArn
| spath output=source_account path=userIdentity.accountId
| rex field=assumed_role "arn:aws:iam::(?<target_account>\d+):role"
| where source_account != target_account
| stats count by source_account, target_account, assumed_role, 
        userIdentity.arn, sourceIPAddress
| sort -count</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>AWS Attack Techniques</h2>
                    
                    <div class="diagram">
                        <div class="diagram-title">Common AWS Attack Patterns</div>
                        <pre><code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       AWS ATTACK TECHNIQUES                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  INITIAL ACCESS                          PERSISTENCE                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ â€¢ Exposed credentials   â”‚            â”‚ â€¢ Create IAM user       â”‚        â”‚
â”‚  â”‚   (GitHub, S3, etc)     â”‚            â”‚ â€¢ Create access key     â”‚        â”‚
â”‚  â”‚ â€¢ Stolen access keys    â”‚            â”‚ â€¢ Lambda backdoor       â”‚        â”‚
â”‚  â”‚ â€¢ SSO/federated abuse   â”‚            â”‚ â€¢ EC2 instance profile  â”‚        â”‚
â”‚  â”‚ â€¢ Phished console creds â”‚            â”‚ â€¢ Cross-account role    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                             â”‚
â”‚  PRIVILEGE ESCALATION                    DEFENSE EVASION                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ â€¢ Attach admin policy   â”‚            â”‚ â€¢ Disable CloudTrail    â”‚        â”‚
â”‚  â”‚ â€¢ Modify role trust     â”‚            â”‚ â€¢ Delete logs           â”‚        â”‚
â”‚  â”‚ â€¢ PassRole abuse        â”‚            â”‚ â€¢ Use different region  â”‚        â”‚
â”‚  â”‚ â€¢ Lambda escalation     â”‚            â”‚ â€¢ Modify GuardDuty      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                             â”‚
â”‚  DATA EXFILTRATION                       IMPACT                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ â€¢ S3 bucket copy        â”‚            â”‚ â€¢ Crypto mining         â”‚        â”‚
â”‚  â”‚ â€¢ RDS snapshot share    â”‚            â”‚ â€¢ Data destruction      â”‚        â”‚
â”‚  â”‚ â€¢ AMI sharing           â”‚            â”‚ â€¢ Ransomware            â”‚        â”‚
â”‚  â”‚ â€¢ EBS snapshot export   â”‚            â”‚ â€¢ Service disruption    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <div class="info-box interview">
                        <div class="info-box-title">ğŸ’¼ Interview Tip</div>
                        <p><strong>Q: "What CloudTrail events would you prioritize for detection?"</strong></p>
                        <p><strong>A:</strong> "I organize CloudTrail detections by attack phase:</p>
                        <ol>
                            <li><strong>Credential Compromise:</strong> ConsoleLogin from unusual locations, CreateAccessKey for users who don't normally have keys, GetSecretValue spikes.</li>
                            <li><strong>Privilege Escalation:</strong> AttachUserPolicy/AttachRolePolicy with admin policies, PutRolePolicy adding permissions, CreatePolicyVersion with elevated access.</li>
                            <li><strong>Persistence:</strong> CreateUser outside normal provisioning, CreateLoginProfile for existing users, CreateAccessKey for service accounts.</li>
                            <li><strong>Defense Evasion:</strong> StopLogging, DeleteTrail, UpdateTrail to different bucket, PutEventSelectors reducing logging.</li>
                            <li><strong>Data Exfiltration:</strong> Unusual GetObject patterns from S3, ModifySnapshotAttribute making snapshots public, CreateSnapshot followed by cross-account share.</li>
                        </ol>
                        <p>I also heavily leverage GuardDuty for ML-based detection of anomalies that rule-based detection might miss."</p>
                    </div>
                </section>

                <section class="content-section">
                    <div class="cheatsheet">
                        <div class="cheatsheet-title">ğŸ“‹ AWS Security Quick Reference</div>
                        <h4>Critical CloudTrail Events</h4>
                        <table>
                            <tr><th>Category</th><th>Events</th></tr>
                            <tr><td>IAM</td><td>CreateUser, CreateAccessKey, Attach*Policy</td></tr>
                            <tr><td>Auth</td><td>ConsoleLogin, AssumeRole</td></tr>
                            <tr><td>S3</td><td>PutBucketPolicy, PutBucketAcl</td></tr>
                            <tr><td>Evasion</td><td>StopLogging, DeleteTrail</td></tr>
                        </table>
                        <h4>GuardDuty Severity</h4>
                        <ul>
                            <li>Low: 1-3 (informational)</li>
                            <li>Medium: 4-6 (investigate)</li>
                            <li>High: 7-9 (urgent response)</li>
                        </ul>
                        <h4>Root Account Rules</h4>
                        <ul>
                            <li>Alert on ANY root activity</li>
                            <li>Root should have MFA</li>
                            <li>No access keys for root</li>
                        </ul>
                    </div>
                </section>

                <div style="display: flex; justify-content: space-between; margin-top: var(--spacing-2xl); padding-top: var(--spacing-lg); border-top: 1px solid var(--border-default);">
                    <a href="azure-security.html" class="card-link">â† Azure Security</a>
                    <a href="cloud-security-monitoring.html" class="card-link">Cloud Monitoring â†’</a>
                </div>
            </div>
        </main>
    </div>
    <script src="main.js"></script>
</body>
</html>
