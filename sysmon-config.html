<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sysmon Configuration | SIEM Consultant Portfolio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <button class="mobile-menu-toggle" aria-label="Toggle navigation"><span></span></button>
    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" style="text-decoration: none; color: inherit;">
                    <div class="sidebar-logo"><div class="sidebar-logo-icon">âš¡</div>SIEM Consultant</div>
                </a>
                <div class="sidebar-subtitle">Knowledge Portfolio</div>
            </div>
                        <nav class="sidebar-nav">
                <!-- Foundation -->
                <div class="nav-section">
                    <div class="nav-section-title">Foundation</div>
                    <a href="index.html" class="nav-item">Home</a>
                    <a href="approach.html" class="nav-item">Consulting Approach</a>
                    <a href="deliverables.html" class="nav-item">Project Deliverables</a>
                    <a href="experience.html" class="nav-item">Experience</a>
                </div>
                
                <!-- SIEM Fundamentals -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Fundamentals</div>
                    <a href="what-is-siem.html" class="nav-item">What is SIEM?</a>
                    <a href="siem-architecture.html" class="nav-item">SIEM Architecture</a>
                    <a href="siem-data-flow.html" class="nav-item">SIEM Data Flow</a>
                    <a href="platform-comparison.html" class="nav-item">Platform Comparison</a>
                    <a href="siem-metrics.html" class="nav-item">SIEM Metrics</a>
                    <a href="siem-health.html" class="nav-item">SIEM Health</a>
                    <a href="siem-rfp.html" class="nav-item">SIEM RFP Guide</a>
                    <a href="security-data-lake.html" class="nav-item">Security Data Lake</a>
                </div>
                
                <!-- SIEM Platforms -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Platforms</div>
                    <a href="splunk-overview.html" class="nav-item">Splunk Overview</a>
                    <a href="splunk-cloud.html" class="nav-item">Splunk Cloud</a>
                    <a href="splunk-hybrid.html" class="nav-item">Splunk Hybrid</a>
                    <a href="sentinel-overview.html" class="nav-item">Microsoft Sentinel</a>
                </div>
                
                <!-- Log Sources -->
                <div class="nav-section">
                    <div class="nav-section-title">Log Sources</div>
                    <a href="log-sources-overview.html" class="nav-item">Log Sources Overview</a>
                    <a href="windows-logs.html" class="nav-item">Windows Logs</a>
                    <a href="linux-logs.html" class="nav-item">Linux Logs</a>
                    <a href="network-logs.html" class="nav-item">Network Logs</a>
                    <a href="cloud-logs.html" class="nav-item">Cloud Logs</a>
                    <a href="endpoint-logs.html" class="nav-item">Endpoint Logs</a>
                    <a href="identity-logs.html" class="nav-item">Identity Logs</a>
                    <a href="application-logs.html" class="nav-item">Application Logs</a>
                </div>
                
                <!-- Log Engineering -->
                <div class="nav-section">
                    <div class="nav-section-title">Log Engineering</div>
                    <a href="log-pipeline.html" class="nav-item">Log Pipeline</a>
                    <a href="log-parsing.html" class="nav-item">Log Parsing</a>
                    <a href="log-retention.html" class="nav-item">Log Retention</a>
                </div>
                
                <!-- SIEM Migrations -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Migrations</div>
                    <a href="migration-methodology.html" class="nav-item">Migration Methodology</a>
                    <a href="discovery-assessment.html" class="nav-item">Discovery & Assessment</a>
                    <a href="log-migration.html" class="nav-item">Log Migration</a>
                    <a href="detection-migration.html" class="nav-item">Detection Migration</a>
                    <a href="query-translation.html" class="nav-item">Query Translation</a>
                </div>
                
                <!-- Detection Engineering -->
                <div class="nav-section">
                    <div class="nav-section-title">Detection Engineering</div>
                    <a href="detection-fundamentals.html" class="nav-item">Detection Fundamentals</a>
                    <a href="use-case-development.html" class="nav-item">Use Case Development</a>
                    <a href="tuning-methodology.html" class="nav-item">Tuning Methodology</a>
                    <a href="sigma-rules.html" class="nav-item">Sigma Rules</a>
                    <a href="alert-enrichment.html" class="nav-item">Alert Enrichment</a>
                    <a href="alert-fatigue.html" class="nav-item">Alert Fatigue</a>
                </div>
                
                <!-- Threat Detection -->
                <div class="nav-section">
                    <div class="nav-section-title">Threat Detection</div>
                    <a href="mitre-attack-intro.html" class="nav-item">MITRE ATT&CK</a>
                    <a href="threat-modeling.html" class="nav-item">Threat Modeling</a>
                    <a href="threat-intelligence.html" class="nav-item">Threat Intelligence</a>
                    <a href="threat-hunting.html" class="nav-item">Threat Hunting</a>
                    <a href="ueba-analytics.html" class="nav-item">UEBA Analytics</a>
                </div>
                
                <!-- Query Languages -->
                <div class="nav-section">
                    <div class="nav-section-title">Query Languages</div>
                    <a href="spl-fundamentals.html" class="nav-item">SPL Fundamentals</a>
                    <a href="kql-fundamentals.html" class="nav-item">KQL Fundamentals</a>
                </div>
                
                <!-- Windows Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Windows Security</div>
                    <a href="sysmon-config.html" class="nav-item active">Sysmon Configuration</a>
                    <a href="windows-attack-techniques.html" class="nav-item">Windows Attacks</a>
                    <a href="windows-hardening.html" class="nav-item">Windows Hardening</a>
                    <a href="powershell-security.html" class="nav-item">PowerShell Security</a>
                </div>
                
                <!-- Cloud Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Cloud Security</div>
                    <a href="cloud-security-monitoring.html" class="nav-item">Cloud Monitoring</a>
                    <a href="azure-security.html" class="nav-item">Azure Security</a>
                    <a href="aws-security.html" class="nav-item">AWS Security</a>
                    <a href="gcp-security.html" class="nav-item">GCP Security</a>
                    <a href="m365-security.html" class="nav-item">M365 Security</a>
                    <a href="container-security.html" class="nav-item">Container Security</a>
                </div>
                
                <!-- Network Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Network Security</div>
                    <a href="network-security-monitoring.html" class="nav-item">Network Monitoring</a>
                    <a href="dns-security.html" class="nav-item">DNS Security</a>
                    <a href="zero-trust.html" class="nav-item">Zero Trust</a>
                </div>
                
                <!-- Identity Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Identity Security</div>
                    <a href="identity-security.html" class="nav-item">Identity Security</a>
                    <a href="active-directory.html" class="nav-item">Active Directory</a>
                </div>
                
                <!-- Data Protection -->
                <div class="nav-section">
                    <div class="nav-section-title">Data Protection</div>
                    <a href="dlp-monitoring.html" class="nav-item">DLP Monitoring</a>
                    <a href="data-classification.html" class="nav-item">Data Classification</a>
                    <a href="data-exfiltration.html" class="nav-item">Data Exfiltration</a>
                    <a href="insider-threats.html" class="nav-item">Insider Threats</a>
                </div>
                
                <!-- Specific Threats -->
                <div class="nav-section">
                    <div class="nav-section-title">Threat Scenarios</div>
                    <a href="phishing-detection.html" class="nav-item">Phishing Detection</a>
                    <a href="ransomware-detection.html" class="nav-item">Ransomware Detection</a>
                    <a href="email-security.html" class="nav-item">Email Security</a>
                </div>
                
                <!-- SOC Operations -->
                <div class="nav-section">
                    <div class="nav-section-title">SOC Operations</div>
                    <a href="soc-operations.html" class="nav-item">SOC Operations</a>
                    <a href="incident-response.html" class="nav-item">Incident Response</a>
                    <a href="incident-metrics.html" class="nav-item">Incident Metrics</a>
                    <a href="case-management.html" class="nav-item">Case Management</a>
                    <a href="dashboard-design.html" class="nav-item">Dashboard Design</a>
                    <a href="runbook-development.html" class="nav-item">Runbook Development</a>
                </div>
                
                <!-- Automation -->
                <div class="nav-section">
                    <div class="nav-section-title">Automation</div>
                    <a href="soar-automation.html" class="nav-item">SOAR Automation</a>
                    <a href="security-playbooks.html" class="nav-item">Security Playbooks</a>
                    <a href="python-security.html" class="nav-item">Python for Security</a>
                </div>
                
                <!-- Integrations -->
                <div class="nav-section">
                    <div class="nav-section-title">Integrations</div>
                    <a href="edr-integration.html" class="nav-item">EDR Integration</a>
                    <a href="vulnerability-management.html" class="nav-item">Vulnerability Mgmt</a>
                    <a href="api-security.html" class="nav-item">API Security</a>
                </div>
                
                <!-- Operations -->
                <div class="nav-section">
                    <div class="nav-section-title">Operations</div>
                    <a href="performance-optimization.html" class="nav-item">Performance</a>
                    <a href="cost-optimization.html" class="nav-item">Cost Optimization</a>
                    <a href="compliance-governance.html" class="nav-item">Compliance</a>
                </div>
                
                <!-- Interview Prep -->
                <div class="nav-section">
                    <div class="nav-section-title">Interview Prep</div>
                    <a href="interview-strategy.html" class="nav-item">â­ Interview Strategy</a>
                    <a href="common-questions.html" class="nav-item">Common Questions</a>
                    <a href="interview-scenarios.html" class="nav-item">Scenarios</a>
                </div>
            </nav>
        </aside>
        <main class="main-content">
            <div class="content-wrapper">
                <nav class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="breadcrumb-separator">/</span>
                    <a href="log-sources-overview.html">Log Sources</a>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-current">Sysmon Configuration</span>
                </nav>

                <header class="page-header">
                    <h1 class="page-title">Sysmon Configuration</h1>
                    <p class="page-subtitle">System Monitor (Sysmon) provides detailed telemetry about process creation, network connections, and file changes. Proper configuration is essentialâ€”too verbose creates noise, too restrictive misses threats.</p>
                </header>

                <section class="content-section">
                    <h2>Sysmon Event Types</h2>
                    
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Event ID</th>
                                    <th>Description</th>
                                    <th>Detection Value</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>1</strong></td>
                                    <td>Process Creation</td>
                                    <td>â­â­â­â­â­ Essential - command lines, parent process</td>
                                </tr>
                                <tr>
                                    <td><strong>2</strong></td>
                                    <td>File creation time changed</td>
                                    <td>â­â­â­ Timestomping detection</td>
                                </tr>
                                <tr>
                                    <td><strong>3</strong></td>
                                    <td>Network connection</td>
                                    <td>â­â­â­â­ Process-to-network mapping</td>
                                </tr>
                                <tr>
                                    <td><strong>5</strong></td>
                                    <td>Process terminated</td>
                                    <td>â­â­ Process lifecycle</td>
                                </tr>
                                <tr>
                                    <td><strong>6</strong></td>
                                    <td>Driver loaded</td>
                                    <td>â­â­â­ Rootkit detection</td>
                                </tr>
                                <tr>
                                    <td><strong>7</strong></td>
                                    <td>Image loaded (DLL)</td>
                                    <td>â­â­â­â­ DLL hijacking, injection</td>
                                </tr>
                                <tr>
                                    <td><strong>8</strong></td>
                                    <td>CreateRemoteThread</td>
                                    <td>â­â­â­â­ Process injection</td>
                                </tr>
                                <tr>
                                    <td><strong>9</strong></td>
                                    <td>RawAccessRead</td>
                                    <td>â­â­ Direct disk access</td>
                                </tr>
                                <tr>
                                    <td><strong>10</strong></td>
                                    <td>Process Access</td>
                                    <td>â­â­â­â­â­ LSASS access, injection</td>
                                </tr>
                                <tr>
                                    <td><strong>11</strong></td>
                                    <td>File created</td>
                                    <td>â­â­â­â­ Malware drops, persistence</td>
                                </tr>
                                <tr>
                                    <td><strong>12/13/14</strong></td>
                                    <td>Registry events</td>
                                    <td>â­â­â­â­ Persistence, config changes</td>
                                </tr>
                                <tr>
                                    <td><strong>15</strong></td>
                                    <td>FileCreateStreamHash</td>
                                    <td>â­â­â­ ADS (alternate data streams)</td>
                                </tr>
                                <tr>
                                    <td><strong>17/18</strong></td>
                                    <td>Pipe created/connected</td>
                                    <td>â­â­â­ C2 communication, lateral movement</td>
                                </tr>
                                <tr>
                                    <td><strong>19/20/21</strong></td>
                                    <td>WMI events</td>
                                    <td>â­â­â­â­ WMI persistence</td>
                                </tr>
                                <tr>
                                    <td><strong>22</strong></td>
                                    <td>DNS query</td>
                                    <td>â­â­â­â­ Process-to-DNS correlation</td>
                                </tr>
                                <tr>
                                    <td><strong>23</strong></td>
                                    <td>File delete archived</td>
                                    <td>â­â­â­ Evidence destruction</td>
                                </tr>
                                <tr>
                                    <td><strong>25</strong></td>
                                    <td>Process tampering</td>
                                    <td>â­â­â­â­ Hollow process, herpaderping</td>
                                </tr>
                                <tr>
                                    <td><strong>26</strong></td>
                                    <td>File delete logged</td>
                                    <td>â­â­ File deletion tracking</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Configuration Approach</h2>
                    
                    <div class="diagram">
                        <div class="diagram-title">Sysmon Configuration Strategy</div>
                        <pre><code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SYSMON CONFIGURATION PHILOSOPHY                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  APPROACH 1: Include Everything, Exclude Noise (Recommended)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  &lt;RuleGroup groupRelation="or"&gt;                                     â”‚   â”‚
â”‚  â”‚    &lt;ProcessCreate onmatch="exclude"&gt;                                â”‚   â”‚
â”‚  â”‚      &lt;!-- Exclude known good --&gt;                                    â”‚   â”‚
â”‚  â”‚      &lt;Image condition="is"&gt;C:\Windows\System32\svchost.exe&lt;/Image&gt;  â”‚   â”‚
â”‚  â”‚    &lt;/ProcessCreate&gt;                                                 â”‚   â”‚
â”‚  â”‚  &lt;/RuleGroup&gt;                                                       â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  Pros: Catch unknown threats, comprehensive visibility              â”‚   â”‚
â”‚  â”‚  Cons: Higher volume, more tuning required                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  APPROACH 2: Exclude Everything, Include Suspicious                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  &lt;RuleGroup groupRelation="or"&gt;                                     â”‚   â”‚
â”‚  â”‚    &lt;ProcessCreate onmatch="include"&gt;                                â”‚   â”‚
â”‚  â”‚      &lt;!-- Include only suspicious --&gt;                               â”‚   â”‚
â”‚  â”‚      &lt;Image condition="contains"&gt;powershell&lt;/Image&gt;                 â”‚   â”‚
â”‚  â”‚    &lt;/ProcessCreate&gt;                                                 â”‚   â”‚
â”‚  â”‚  &lt;/RuleGroup&gt;                                                       â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  Pros: Lower volume, focused                                        â”‚   â”‚
â”‚  â”‚  Cons: May miss novel attacks, requires constant updates            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Sample Configuration</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">Sysmon Config: Process Creation (Event 1)</div>
                        <pre><code>&lt;Sysmon schemaversion="4.90"&gt;
  &lt;HashAlgorithms&gt;md5,sha256,IMPHASH&lt;/HashAlgorithms&gt;
  &lt;EventFiltering&gt;
    
    &lt;!-- Process Creation: Exclude noisy, known-good processes --&gt;
    &lt;RuleGroup name="ProcessCreate" groupRelation="or"&gt;
      &lt;ProcessCreate onmatch="exclude"&gt;
        &lt;!-- Windows noise --&gt;
        &lt;Image condition="is"&gt;C:\Windows\System32\backgroundTaskHost.exe&lt;/Image&gt;
        &lt;Image condition="is"&gt;C:\Windows\System32\RuntimeBroker.exe&lt;/Image&gt;
        &lt;Image condition="is"&gt;C:\Windows\System32\SearchProtocolHost.exe&lt;/Image&gt;
        &lt;Image condition="is"&gt;C:\Windows\System32\SearchFilterHost.exe&lt;/Image&gt;
        
        &lt;!-- Antivirus/EDR (adjust for your tools) --&gt;
        &lt;Image condition="contains"&gt;Microsoft\Windows Defender&lt;/Image&gt;
        &lt;Image condition="contains"&gt;CrowdStrike&lt;/Image&gt;
        
        &lt;!-- Chrome/browser noise --&gt;
        &lt;ParentImage condition="end with"&gt;chrome.exe&lt;/ParentImage&gt;
        &lt;Image condition="end with"&gt;chrome.exe&lt;/Image&gt;
        
        &lt;!-- Development tools (adjust for your environment) --&gt;
        &lt;Image condition="contains"&gt;Visual Studio&lt;/Image&gt;
      &lt;/ProcessCreate&gt;
    &lt;/RuleGroup&gt;</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">Sysmon Config: Network Connections (Event 3)</div>
                        <pre><code>    &lt;!-- Network Connection: Focus on interesting connections --&gt;
    &lt;RuleGroup name="NetworkConnect" groupRelation="or"&gt;
      &lt;NetworkConnect onmatch="exclude"&gt;
        &lt;!-- Exclude localhost --&gt;
        &lt;DestinationIp condition="is"&gt;127.0.0.1&lt;/DestinationIp&gt;
        &lt;DestinationIp condition="is"&gt;::1&lt;/DestinationIp&gt;
        
        &lt;!-- Exclude known browsers to common CDNs --&gt;
        &lt;Image condition="end with"&gt;chrome.exe&lt;/Image&gt;
        &lt;Image condition="end with"&gt;msedge.exe&lt;/Image&gt;
        
        &lt;!-- Exclude known good services --&gt;
        &lt;Image condition="is"&gt;C:\Windows\System32\svchost.exe&lt;/Image&gt;
        
        &lt;!-- Exclude internal networks (adjust for your ranges) --&gt;
        &lt;DestinationIp condition="begin with"&gt;10.&lt;/DestinationIp&gt;
        &lt;DestinationIp condition="begin with"&gt;192.168.&lt;/DestinationIp&gt;
      &lt;/NetworkConnect&gt;
    &lt;/RuleGroup&gt;</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">Sysmon Config: Process Access (Event 10)</div>
                        <pre><code>    &lt;!-- Process Access: Critical for credential theft detection --&gt;
    &lt;RuleGroup name="ProcessAccess" groupRelation="or"&gt;
      &lt;ProcessAccess onmatch="include"&gt;
        &lt;!-- LSASS access is always interesting --&gt;
        &lt;TargetImage condition="end with"&gt;lsass.exe&lt;/TargetImage&gt;
      &lt;/ProcessAccess&gt;
      &lt;ProcessAccess onmatch="exclude"&gt;
        &lt;!-- Exclude system processes accessing LSASS --&gt;
        &lt;SourceImage condition="is"&gt;C:\Windows\System32\wbem\WmiPrvSE.exe&lt;/SourceImage&gt;
        &lt;SourceImage condition="is"&gt;C:\Windows\System32\lsass.exe&lt;/SourceImage&gt;
        &lt;SourceImage condition="contains"&gt;Windows Defender&lt;/SourceImage&gt;
      &lt;/ProcessAccess&gt;
    &lt;/RuleGroup&gt;</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">Sysmon Config: Registry Events (Event 12/13/14)</div>
                        <pre><code>    &lt;!-- Registry: Focus on persistence locations --&gt;
    &lt;RuleGroup name="RegistryEvent" groupRelation="or"&gt;
      &lt;RegistryEvent onmatch="include"&gt;
        &lt;!-- Run keys --&gt;
        &lt;TargetObject condition="contains"&gt;\CurrentVersion\Run&lt;/TargetObject&gt;
        &lt;TargetObject condition="contains"&gt;\CurrentVersion\RunOnce&lt;/TargetObject&gt;
        
        &lt;!-- Services --&gt;
        &lt;TargetObject condition="contains"&gt;\Services\&lt;/TargetObject&gt;
        
        &lt;!-- Image File Execution Options (debugger persistence) --&gt;
        &lt;TargetObject condition="contains"&gt;\Image File Execution Options\&lt;/TargetObject&gt;
        
        &lt;!-- Windows Defender settings --&gt;
        &lt;TargetObject condition="contains"&gt;\Windows Defender\&lt;/TargetObject&gt;
        
        &lt;!-- Security settings --&gt;
        &lt;TargetObject condition="contains"&gt;\Policies\&lt;/TargetObject&gt;
      &lt;/RegistryEvent&gt;
    &lt;/RuleGroup&gt;</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">Sysmon Config: DNS Queries (Event 22)</div>
                        <pre><code>    &lt;!-- DNS Query: Exclude common noise --&gt;
    &lt;RuleGroup name="DnsQuery" groupRelation="or"&gt;
      &lt;DnsQuery onmatch="exclude"&gt;
        &lt;!-- Microsoft telemetry --&gt;
        &lt;QueryName condition="end with"&gt;.microsoft.com&lt;/QueryName&gt;
        &lt;QueryName condition="end with"&gt;.windows.com&lt;/QueryName&gt;
        &lt;QueryName condition="end with"&gt;.windowsupdate.com&lt;/QueryName&gt;
        
        &lt;!-- Google --&gt;
        &lt;QueryName condition="end with"&gt;.google.com&lt;/QueryName&gt;
        &lt;QueryName condition="end with"&gt;.googleapis.com&lt;/QueryName&gt;
        
        &lt;!-- CDNs --&gt;
        &lt;QueryName condition="end with"&gt;.akamai.net&lt;/QueryName&gt;
        &lt;QueryName condition="end with"&gt;.cloudfront.net&lt;/QueryName&gt;
      &lt;/DnsQuery&gt;
    &lt;/RuleGroup&gt;
    
  &lt;/EventFiltering&gt;
&lt;/Sysmon&gt;</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Community Configurations</h2>
                    
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Config</th>
                                    <th>Approach</th>
                                    <th>Best For</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>SwiftOnSecurity</strong></td>
                                    <td>Balanced, well-documented</td>
                                    <td>Starting point, enterprise deployment</td>
                                </tr>
                                <tr>
                                    <td><strong>Olaf Hartong</strong></td>
                                    <td>Modular, ATT&CK mapped</td>
                                    <td>Detection-focused environments</td>
                                </tr>
                                <tr>
                                    <td><strong>ion-storm</strong></td>
                                    <td>Comprehensive, verbose</td>
                                    <td>Threat hunting, high-visibility needs</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Deployment Commands</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">Sysmon Installation & Management</div>
                        <pre><code># Install Sysmon with config
sysmon64.exe -accepteula -i sysmonconfig.xml

# Update config on running Sysmon
sysmon64.exe -c sysmonconfig.xml

# Show current config
sysmon64.exe -c

# Uninstall
sysmon64.exe -u

# Check Sysmon service status
sc query sysmon64

# View Sysmon events in PowerShell
Get-WinEvent -LogName "Microsoft-Windows-Sysmon/Operational" -MaxEvents 10</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Volume Management</h2>
                    
                    <div class="info-box warning">
                        <div class="info-box-title">âš ï¸ Event Volume Considerations</div>
                        <p>Sysmon can generate significant event volume. Monitor and tune:</p>
                        <ul>
                            <li><strong>Event 3 (Network):</strong> Can be extremely noisyâ€”filter aggressively</li>
                            <li><strong>Event 7 (Image Load):</strong> Very high volume, consider enabling only for specific processes</li>
                            <li><strong>Event 11 (File Create):</strong> High volume, focus on specific paths</li>
                        </ul>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">SPL: Sysmon Volume Analysis</div>
                        <pre><code>index=windows sourcetype="XmlWinEventLog:Microsoft-Windows-Sysmon/Operational"
| stats count by EventCode
| sort -count
| eval event_type = case(
    EventCode=1, "Process Create",
    EventCode=3, "Network Connect",
    EventCode=7, "Image Load",
    EventCode=10, "Process Access",
    EventCode=11, "File Create",
    EventCode=13, "Registry Value Set",
    EventCode=22, "DNS Query",
    true(), "Other"
)
| table EventCode, event_type, count</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <div class="info-box interview">
                        <div class="info-box-title">ğŸ’¼ Interview Tip</div>
                        <p><strong>Q: "How would you approach Sysmon configuration for an enterprise?"</strong></p>
                        <p><strong>A:</strong> "I follow a phased approach:</p>
                        <ol>
                            <li><strong>Start with community config:</strong> SwiftOnSecurity's config is an excellent baselineâ€”well-documented, balanced between visibility and noise.</li>
                            <li><strong>Prioritize high-value events:</strong> Event 1 (Process Create) with command lines is essential. Event 10 (Process Access) targeting LSASS catches credential theft. Event 22 (DNS) provides process-to-domain mapping.</li>
                            <li><strong>Environment-specific tuning:</strong> Every environment has noisy applications. I analyze volume by event type, identify the top noise generators, and add targeted exclusions.</li>
                            <li><strong>Iterate based on detection needs:</strong> As I develop detections, I may need events I initially filtered. The config evolves with detection requirements.</li>
                            <li><strong>Monitor volume:</strong> I track Sysmon event volume in the SIEM. Sudden spikes indicate either attack activity or a new noisy application that needs filtering.</li>
                        </ol>
                        <p>The goal is maximum detection value per eventâ€”I want to log what's needed to detect attacks without drowning in noise that obscures real threats."</p>
                    </div>
                </section>

                <section class="content-section">
                    <div class="cheatsheet">
                        <div class="cheatsheet-title">ğŸ“‹ Sysmon Quick Reference</div>
                        <h4>Essential Events</h4>
                        <ul>
                            <li>1 - Process Create (command lines)</li>
                            <li>3 - Network Connection</li>
                            <li>10 - Process Access (LSASS)</li>
                            <li>11 - File Create</li>
                            <li>13 - Registry Value Set</li>
                            <li>22 - DNS Query</li>
                        </ul>
                        <h4>High Volume Events</h4>
                        <ul>
                            <li>7 - Image Load (DLL)</li>
                            <li>3 - Network Connection</li>
                            <li>11 - File Create</li>
                        </ul>
                        <h4>Condition Operators</h4>
                        <ul>
                            <li><code>is</code> - Exact match</li>
                            <li><code>contains</code> - Substring</li>
                            <li><code>begin with</code> - Prefix</li>
                            <li><code>end with</code> - Suffix</li>
                            <li><code>image</code> - Image path only</li>
                        </ul>
                    </div>
                </section>

                <div style="display: flex; justify-content: space-between; margin-top: var(--spacing-2xl); padding-top: var(--spacing-lg); border-top: 1px solid var(--border-default);">
                    <a href="windows-logs.html" class="card-link">â† Windows Logs</a>
                    <a href="endpoint-logs.html" class="card-link">Endpoint Logs â†’</a>
                </div>
            </div>
        </main>
    </div>
    <script src="main.js"></script>
</body>
</html>
