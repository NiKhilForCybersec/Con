<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vulnerability Management | SIEM Consultant Portfolio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <button class="mobile-menu-toggle" aria-label="Toggle navigation"><span></span></button>
    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" style="text-decoration: none; color: inherit;">
                    <div class="sidebar-logo"><div class="sidebar-logo-icon">âš¡</div>SIEM Consultant</div>
                </a>
                <div class="sidebar-subtitle">Knowledge Portfolio</div>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Foundation</div>
                    <a href="index.html" class="nav-item">Home</a>
                    <a href="approach.html" class="nav-item">Consulting Approach</a>
                    <a href="experience.html" class="nav-item">Experience</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Security Operations</div>
                    <a href="soc-operations.html" class="nav-item">SOC Operations</a>
                    <a href="vulnerability-management.html" class="nav-item active">Vulnerability Mgmt</a>
                </div>
            </nav>
        </aside>
        <main class="main-content">
            <div class="content-wrapper">
                <nav class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-current">Vulnerability Management</span>
                </nav>

                <header class="page-header">
                    <h1 class="page-title">Vulnerability Management Integration</h1>
                    <p class="page-subtitle">Integrating vulnerability data with SIEM enables risk-based prioritization. When an alert fires, knowing if the target has critical vulnerabilities changes the response priority entirely.</p>
                </header>

                <section class="content-section">
                    <h2>VM-SIEM Integration Value</h2>
                    
                    <div class="diagram">
                        <div class="diagram-title">Vulnerability Context in Detection</div>
                        <pre><code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 VULNERABILITY-AWARE DETECTION                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  WITHOUT VM INTEGRATION:                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Alert: Suspicious network scan detected targeting 10.1.1.50         â”‚   â”‚
â”‚  â”‚ Priority: Medium (based on alert rule alone)                        â”‚   â”‚
â”‚  â”‚ Context: None                                                        â”‚   â”‚
â”‚  â”‚ Action: Queue for review                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  WITH VM INTEGRATION:                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Alert: Suspicious network scan detected targeting 10.1.1.50         â”‚   â”‚
â”‚  â”‚ Asset: Production SQL Server (Critical Asset)                       â”‚   â”‚
â”‚  â”‚ Vulnerabilities:                                                     â”‚   â”‚
â”‚  â”‚   â€¢ CVE-2024-21762 (CVSS 9.8) - Remote Code Execution               â”‚   â”‚
â”‚  â”‚   â€¢ CVE-2024-1234 (CVSS 8.5) - SQL Injection                        â”‚   â”‚
â”‚  â”‚ Exploit Available: YES (Metasploit)                                  â”‚   â”‚
â”‚  â”‚ Priority: CRITICAL (auto-elevated)                                   â”‚   â”‚
â”‚  â”‚ Action: Immediate investigation, potential active exploitation      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Vulnerability Data Sources</h2>
                    
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Source</th>
                                    <th>Data Type</th>
                                    <th>Integration Method</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Qualys</strong></td>
                                    <td>VM scan results, asset inventory</td>
                                    <td>API polling, Splunk add-on</td>
                                </tr>
                                <tr>
                                    <td><strong>Tenable/Nessus</strong></td>
                                    <td>Vulnerability findings, compliance</td>
                                    <td>API, Syslog, native connector</td>
                                </tr>
                                <tr>
                                    <td><strong>Rapid7 InsightVM</strong></td>
                                    <td>Risk scores, remediation tracking</td>
                                    <td>API, Log forwarding</td>
                                </tr>
                                <tr>
                                    <td><strong>Microsoft Defender VM</strong></td>
                                    <td>Software vulnerabilities, misconfigs</td>
                                    <td>Native to Sentinel/M365D</td>
                                </tr>
                                <tr>
                                    <td><strong>CrowdStrike Spotlight</strong></td>
                                    <td>Real-time vulnerability assessment</td>
                                    <td>Falcon API, native to Falcon</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Vulnerability Enrichment</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Enrich Alerts with Vulnerabilities</div>
                        <pre><code>// Join security alerts with vulnerability data
SecurityAlert
| where TimeGenerated > ago(24h)
| extend TargetIP = tostring(parse_json(ExtendedProperties).["Target IP"])
| join kind=leftouter (
    DeviceTvmSoftwareVulnerabilities
    | where VulnerabilitySeverityLevel in ("Critical", "High")
    | summarize 
        CriticalVulns = countif(VulnerabilitySeverityLevel == "Critical"),
        HighVulns = countif(VulnerabilitySeverityLevel == "High"),
        CVEs = make_set(CveId, 10)
      by DeviceId, DeviceName
) on $left.TargetIP == $right.DeviceName
| extend RiskMultiplier = case(
    CriticalVulns > 0, 3,
    HighVulns > 5, 2,
    1
)
| extend AdjustedSeverity = Severity * RiskMultiplier
| project TimeGenerated, AlertName, TargetIP, 
          CriticalVulns, HighVulns, CVEs, AdjustedSeverity</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">SPL: Vulnerability Lookup Enrichment</div>
                        <pre><code>index=security_alerts
| lookup vulnerability_data ip as dest_ip 
    OUTPUT vuln_count, critical_count, cve_list, last_scan_date
| eval risk_score = case(
    critical_count > 0, severity * 3,
    vuln_count > 10, severity * 2,
    severity
)
| where risk_score >= 6
| table _time, alert_name, dest_ip, severity, risk_score, 
        critical_count, cve_list</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Exploit Detection</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Attacks Against Known Vulnerabilities</div>
                        <pre><code>// Correlate IDS alerts with vulnerable assets
CommonSecurityLog
| where TimeGenerated > ago(24h)
| where DeviceVendor == "Palo Alto Networks"
| where Activity has "vulnerability"
| extend CVE = extract(@"(CVE-\d{4}-\d+)", 1, Message)
| join kind=inner (
    DeviceTvmSoftwareVulnerabilities
    | project DeviceName, CveId
) on $left.DestinationHostName == $right.DeviceName, 
   $left.CVE == $right.CveId
| project TimeGenerated, SourceIP, DestinationHostName, 
          CVE, Activity
| summarize AttackCount = count() by CVE, DestinationHostName
| order by AttackCount desc</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">SPL: Active Exploitation Attempts</div>
                        <pre><code>index=ids signature_category="attempted-exploit"
| lookup known_exploited_vulns cve as signature_cve OUTPUT cisa_added_date
| where isnotnull(cisa_added_date)  // CISA KEV list
| lookup vulnerability_data ip as dest_ip OUTPUT affected_cves
| where signature_cve IN (affected_cves)  // Target is actually vulnerable
| stats count, values(signature_name) as exploits 
  by dest_ip, signature_cve
| sort -count</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>CISA KEV Integration</h2>
                    <p>The CISA Known Exploited Vulnerabilities (KEV) catalog identifies vulnerabilities with active exploitation:</p>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Assets with KEV Vulnerabilities</div>
                        <pre><code>// Cross-reference with CISA KEV
let KEVList = externaldata(cveID:string, vendorProject:string, 
                           product:string, dateAdded:datetime)
[@"https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json"]
with(format="json", ingestionMapping='[{"column":"cveID","path":"$.cveID"}]');
DeviceTvmSoftwareVulnerabilities
| join kind=inner KEVList on $left.CveId == $right.cveID
| summarize 
    KEVCount = dcount(CveId),
    KEVs = make_set(CveId)
  by DeviceName, DeviceId
| order by KEVCount desc</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Vulnerability Trending</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">SPL: Vulnerability Trend Analysis</div>
                        <pre><code>index=vulnerability_scans
| bucket _time span=1w
| stats dc(host) as scanned_hosts,
        sum(critical_count) as total_critical,
        sum(high_count) as total_high,
        avg(vuln_count) as avg_vulns_per_host
  by _time
| eval critical_per_host = round(total_critical / scanned_hosts, 1)
| timechart span=1w avg(critical_per_host) as "Critical/Host"</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">KQL: New Vulnerabilities This Week</div>
                        <pre><code>DeviceTvmSoftwareVulnerabilities
| where TimeGenerated > ago(7d)
| where VulnerabilitySeverityLevel in ("Critical", "High")
| join kind=leftanti (
    DeviceTvmSoftwareVulnerabilities
    | where TimeGenerated between (ago(14d) .. ago(7d))
    | project DeviceId, CveId
) on DeviceId, CveId
| summarize 
    NewVulnCount = dcount(CveId),
    AffectedDevices = dcount(DeviceId),
    NewCVEs = make_set(CveId, 20)
  by VulnerabilitySeverityLevel
| order by VulnerabilitySeverityLevel</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Risk-Based Prioritization</h2>
                    
                    <div class="diagram">
                        <div class="diagram-title">Vulnerability Prioritization Matrix</div>
                        <pre><code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PRIORITIZATION FACTORS                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  CVSS Score         Asset Criticality      Exploitability                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ 9.0-10.0 â—â—â—â”‚   â”‚ Crown Jewels â—â—â—â”‚    â”‚ In-the-Wild â—â—â—â”‚              â”‚
â”‚  â”‚ 7.0-8.9  â—â— â”‚   â”‚ Critical     â—â— â”‚    â”‚ POC Exists  â—â— â”‚              â”‚
â”‚  â”‚ 4.0-6.9  â—  â”‚   â”‚ Standard     â—  â”‚    â”‚ Theoretical â—  â”‚              â”‚
â”‚  â”‚ 0.0-3.9     â”‚   â”‚ Dev/Test        â”‚    â”‚ No exploit     â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                             â”‚
â”‚  COMPOSITE RISK SCORE:                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Risk = CVSS Ã— Asset_Weight Ã— Exploit_Weight Ã— Exposure_Weight       â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ Example:                                                             â”‚   â”‚
â”‚  â”‚ CVE-2024-1234 (CVSS 9.0) on Production DB (Critical) with           â”‚   â”‚
â”‚  â”‚ Metasploit module (POC exists), Internet-facing                     â”‚   â”‚
â”‚  â”‚ Risk = 9.0 Ã— 3 Ã— 2 Ã— 2 = 108 â†’ IMMEDIATE                            â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ CVE-2024-5678 (CVSS 7.5) on Dev Server (Low) with                   â”‚   â”‚
â”‚  â”‚ No exploit, Internal only                                            â”‚   â”‚
â”‚  â”‚ Risk = 7.5 Ã— 0.5 Ã— 0.5 Ã— 0.5 = 0.94 â†’ LOW PRIORITY                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>SLA Monitoring</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">SPL: Remediation SLA Tracking</div>
                        <pre><code>index=vulnerability_scans
| lookup vulnerability_sla severity OUTPUT sla_days
| eval days_open = round((now() - first_detected) / 86400)
| eval sla_status = case(
    days_open > sla_days, "Overdue",
    days_open > sla_days * 0.8, "At Risk",
    "On Track"
)
| stats count by severity, sla_status
| xyseries severity, sla_status, count</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <div class="info-box interview">
                        <div class="info-box-title">ğŸ’¼ Interview Tip</div>
                        <p><strong>Q: "How do you use vulnerability data in security monitoring?"</strong></p>
                        <p><strong>A:</strong> "Vulnerability data transforms detection from generic to risk-aware:</p>
                        <ol>
                            <li><strong>Alert prioritization:</strong> Same attack against two servers has different priority if one has critical unpatched vulnerabilities. I enrich alerts with vulnerability context and auto-elevate when attacks target vulnerable assets.</li>
                            <li><strong>Proactive hunting:</strong> When a new critical CVE drops, I immediately query which assets are vulnerable. Combined with network logs, I can see if those assets are being probed before exploitation.</li>
                            <li><strong>Risk scoring:</strong> I calculate composite risk using CVSS, asset criticality, exploit availability (especially CISA KEV), and exposure. This drives both vulnerability remediation priority and detection priority.</li>
                            <li><strong>Attack validation:</strong> IDS alerts for exploit attempts are more credible when the target actually has the vulnerability. This reduces false positivesâ€”if the target isn't vulnerable to CVE-2024-1234, the CVE-2024-1234 exploit alert is likely a scanner, not an attack.</li>
                            <li><strong>Compliance:</strong> SLA tracking ensures critical vulnerabilities are remediated within policy timeframes. The SIEM dashboards show remediation status to leadership.</li>
                        </ol>
                        <p>The integration requires maintaining fresh vulnerability dataâ€”stale scan results don't help. I ensure scans run frequently and data syncs to SIEM within hours."</p>
                    </div>
                </section>

                <section class="content-section">
                    <div class="cheatsheet">
                        <div class="cheatsheet-title">ğŸ“‹ Vulnerability Management Quick Reference</div>
                        <h4>CVSS Severity Levels</h4>
                        <ul>
                            <li>Critical: 9.0 - 10.0</li>
                            <li>High: 7.0 - 8.9</li>
                            <li>Medium: 4.0 - 6.9</li>
                            <li>Low: 0.1 - 3.9</li>
                        </ul>
                        <h4>Typical Remediation SLAs</h4>
                        <ul>
                            <li>Critical: 7-15 days</li>
                            <li>High: 30 days</li>
                            <li>Medium: 90 days</li>
                            <li>Low: 180 days</li>
                        </ul>
                        <h4>Priority Multipliers</h4>
                        <ul>
                            <li>CISA KEV listed: 3x</li>
                            <li>Internet-facing: 2x</li>
                            <li>Critical asset: 2x</li>
                            <li>Exploit available: 2x</li>
                        </ul>
                    </div>
                </section>

                <div style="display: flex; justify-content: space-between; margin-top: var(--spacing-2xl); padding-top: var(--spacing-lg); border-top: 1px solid var(--border-default);">
                    <a href="soc-operations.html" class="card-link">â† SOC Operations</a>
                    <a href="threat-intelligence.html" class="card-link">Threat Intelligence â†’</a>
                </div>
            </div>
        </main>
    </div>
    <script src="main.js"></script>
</body>
</html>
