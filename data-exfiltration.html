<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Exfiltration Detection | SIEM Consultant Portfolio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <button class="mobile-menu-toggle" aria-label="Toggle navigation"><span></span></button>
    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" style="text-decoration: none; color: inherit;">
                    <div class="sidebar-logo"><div class="sidebar-logo-icon">âš¡</div>SIEM Consultant</div>
                </a>
                <div class="sidebar-subtitle">Knowledge Portfolio</div>
            </div>
                        <nav class="sidebar-nav">
                <!-- Foundation -->
                <div class="nav-section">
                    <div class="nav-section-title">Foundation</div>
                    <a href="index.html" class="nav-item">Home</a>
                    <a href="approach.html" class="nav-item">Consulting Approach</a>
                    <a href="deliverables.html" class="nav-item">Project Deliverables</a>
                    <a href="experience.html" class="nav-item">Experience</a>
                </div>
                
                <!-- SIEM Fundamentals -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Fundamentals</div>
                    <a href="what-is-siem.html" class="nav-item">What is SIEM?</a>
                    <a href="siem-architecture.html" class="nav-item">SIEM Architecture</a>
                    <a href="siem-data-flow.html" class="nav-item">SIEM Data Flow</a>
                    <a href="platform-comparison.html" class="nav-item">Platform Comparison</a>
                    <a href="siem-metrics.html" class="nav-item">SIEM Metrics</a>
                    <a href="siem-health.html" class="nav-item">SIEM Health</a>
                    <a href="siem-rfp.html" class="nav-item">SIEM RFP Guide</a>
                    <a href="security-data-lake.html" class="nav-item">Security Data Lake</a>
                </div>
                
                <!-- SIEM Platforms -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Platforms</div>
                    <a href="splunk-overview.html" class="nav-item">Splunk Overview</a>
                    <a href="splunk-cloud.html" class="nav-item">Splunk Cloud</a>
                    <a href="splunk-hybrid.html" class="nav-item">Splunk Hybrid</a>
                    <a href="sentinel-overview.html" class="nav-item">Microsoft Sentinel</a>
                </div>
                
                <!-- Log Sources -->
                <div class="nav-section">
                    <div class="nav-section-title">Log Sources</div>
                    <a href="log-sources-overview.html" class="nav-item">Log Sources Overview</a>
                    <a href="windows-logs.html" class="nav-item">Windows Logs</a>
                    <a href="linux-logs.html" class="nav-item">Linux Logs</a>
                    <a href="network-logs.html" class="nav-item">Network Logs</a>
                    <a href="cloud-logs.html" class="nav-item">Cloud Logs</a>
                    <a href="endpoint-logs.html" class="nav-item">Endpoint Logs</a>
                    <a href="identity-logs.html" class="nav-item">Identity Logs</a>
                    <a href="application-logs.html" class="nav-item">Application Logs</a>
                </div>
                
                <!-- Log Engineering -->
                <div class="nav-section">
                    <div class="nav-section-title">Log Engineering</div>
                    <a href="log-pipeline.html" class="nav-item">Log Pipeline</a>
                    <a href="log-parsing.html" class="nav-item">Log Parsing</a>
                    <a href="log-retention.html" class="nav-item">Log Retention</a>
                </div>
                
                <!-- SIEM Migrations -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Migrations</div>
                    <a href="migration-methodology.html" class="nav-item">Migration Methodology</a>
                    <a href="discovery-assessment.html" class="nav-item">Discovery & Assessment</a>
                    <a href="log-migration.html" class="nav-item">Log Migration</a>
                    <a href="detection-migration.html" class="nav-item">Detection Migration</a>
                    <a href="query-translation.html" class="nav-item">Query Translation</a>
                </div>
                
                <!-- Detection Engineering -->
                <div class="nav-section">
                    <div class="nav-section-title">Detection Engineering</div>
                    <a href="detection-fundamentals.html" class="nav-item">Detection Fundamentals</a>
                    <a href="use-case-development.html" class="nav-item">Use Case Development</a>
                    <a href="tuning-methodology.html" class="nav-item">Tuning Methodology</a>
                    <a href="sigma-rules.html" class="nav-item">Sigma Rules</a>
                    <a href="alert-enrichment.html" class="nav-item">Alert Enrichment</a>
                    <a href="alert-fatigue.html" class="nav-item">Alert Fatigue</a>
                </div>
                
                <!-- Threat Detection -->
                <div class="nav-section">
                    <div class="nav-section-title">Threat Detection</div>
                    <a href="mitre-attack-intro.html" class="nav-item">MITRE ATT&CK</a>
                    <a href="threat-modeling.html" class="nav-item">Threat Modeling</a>
                    <a href="threat-intelligence.html" class="nav-item">Threat Intelligence</a>
                    <a href="threat-hunting.html" class="nav-item">Threat Hunting</a>
                    <a href="ueba-analytics.html" class="nav-item">UEBA Analytics</a>
                </div>
                
                <!-- Query Languages -->
                <div class="nav-section">
                    <div class="nav-section-title">Query Languages</div>
                    <a href="spl-fundamentals.html" class="nav-item">SPL Fundamentals</a>
                    <a href="kql-fundamentals.html" class="nav-item">KQL Fundamentals</a>
                </div>
                
                <!-- Windows Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Windows Security</div>
                    <a href="sysmon-config.html" class="nav-item">Sysmon Configuration</a>
                    <a href="windows-attack-techniques.html" class="nav-item">Windows Attacks</a>
                    <a href="windows-hardening.html" class="nav-item">Windows Hardening</a>
                    <a href="powershell-security.html" class="nav-item">PowerShell Security</a>
                </div>
                
                <!-- Cloud Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Cloud Security</div>
                    <a href="cloud-security-monitoring.html" class="nav-item">Cloud Monitoring</a>
                    <a href="azure-security.html" class="nav-item">Azure Security</a>
                    <a href="aws-security.html" class="nav-item">AWS Security</a>
                    <a href="gcp-security.html" class="nav-item">GCP Security</a>
                    <a href="m365-security.html" class="nav-item">M365 Security</a>
                    <a href="container-security.html" class="nav-item">Container Security</a>
                </div>
                
                <!-- Network Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Network Security</div>
                    <a href="network-security-monitoring.html" class="nav-item">Network Monitoring</a>
                    <a href="dns-security.html" class="nav-item">DNS Security</a>
                    <a href="zero-trust.html" class="nav-item">Zero Trust</a>
                </div>
                
                <!-- Identity Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Identity Security</div>
                    <a href="identity-security.html" class="nav-item">Identity Security</a>
                    <a href="active-directory.html" class="nav-item">Active Directory</a>
                </div>
                
                <!-- Data Protection -->
                <div class="nav-section">
                    <div class="nav-section-title">Data Protection</div>
                    <a href="dlp-monitoring.html" class="nav-item">DLP Monitoring</a>
                    <a href="data-classification.html" class="nav-item">Data Classification</a>
                    <a href="data-exfiltration.html" class="nav-item active">Data Exfiltration</a>
                    <a href="insider-threats.html" class="nav-item">Insider Threats</a>
                </div>
                
                <!-- Specific Threats -->
                <div class="nav-section">
                    <div class="nav-section-title">Threat Scenarios</div>
                    <a href="phishing-detection.html" class="nav-item">Phishing Detection</a>
                    <a href="ransomware-detection.html" class="nav-item">Ransomware Detection</a>
                    <a href="email-security.html" class="nav-item">Email Security</a>
                </div>
                
                <!-- SOC Operations -->
                <div class="nav-section">
                    <div class="nav-section-title">SOC Operations</div>
                    <a href="soc-operations.html" class="nav-item">SOC Operations</a>
                    <a href="incident-response.html" class="nav-item">Incident Response</a>
                    <a href="incident-metrics.html" class="nav-item">Incident Metrics</a>
                    <a href="case-management.html" class="nav-item">Case Management</a>
                    <a href="dashboard-design.html" class="nav-item">Dashboard Design</a>
                    <a href="runbook-development.html" class="nav-item">Runbook Development</a>
                </div>
                
                <!-- Automation -->
                <div class="nav-section">
                    <div class="nav-section-title">Automation</div>
                    <a href="soar-automation.html" class="nav-item">SOAR Automation</a>
                    <a href="security-playbooks.html" class="nav-item">Security Playbooks</a>
                    <a href="python-security.html" class="nav-item">Python for Security</a>
                </div>
                
                <!-- Integrations -->
                <div class="nav-section">
                    <div class="nav-section-title">Integrations</div>
                    <a href="edr-integration.html" class="nav-item">EDR Integration</a>
                    <a href="vulnerability-management.html" class="nav-item">Vulnerability Mgmt</a>
                    <a href="api-security.html" class="nav-item">API Security</a>
                </div>
                
                <!-- Operations -->
                <div class="nav-section">
                    <div class="nav-section-title">Operations</div>
                    <a href="performance-optimization.html" class="nav-item">Performance</a>
                    <a href="cost-optimization.html" class="nav-item">Cost Optimization</a>
                    <a href="compliance-governance.html" class="nav-item">Compliance</a>
                </div>
                
                <!-- Interview Prep -->
                <div class="nav-section">
                    <div class="nav-section-title">Interview Prep</div>
                    <a href="interview-strategy.html" class="nav-item">â­ Interview Strategy</a>
                    <a href="common-questions.html" class="nav-item">Common Questions</a>
                    <a href="interview-scenarios.html" class="nav-item">Scenarios</a>
                </div>
            </nav>
        </aside>
        <main class="main-content">
            <div class="content-wrapper">
                <nav class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-current">Data Exfiltration Detection</span>
                </nav>

                <header class="page-header">
                    <h1 class="page-title">Data Exfiltration Detection</h1>
                    <p class="page-subtitle">Data exfiltration is often the ultimate goal of attacks. Detecting unusual data movement patternsâ€”whether via network, cloud, or physical meansâ€”is critical for preventing data breaches.</p>
                </header>

                <section class="content-section">
                    <h2>Exfiltration Channels</h2>
                    
                    <div class="diagram">
                        <div class="diagram-title">Data Exfiltration Vectors</div>
                        <pre><code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EXFILTRATION CHANNELS                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  NETWORK-BASED                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â€¢ Web uploads (HTTP/HTTPS POST)     â€¢ Cloud storage (Dropbox, GDrive)â”‚   â”‚
â”‚  â”‚ â€¢ Email attachments                 â€¢ FTP/SFTP transfers            â”‚   â”‚
â”‚  â”‚ â€¢ DNS tunneling                     â€¢ Encrypted tunnels (SSH, VPN)  â”‚   â”‚
â”‚  â”‚ â€¢ C2 channels                       â€¢ Steganography                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  ENDPOINT-BASED                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â€¢ USB/removable media               â€¢ Printing sensitive data       â”‚   â”‚
â”‚  â”‚ â€¢ Bluetooth transfer                â€¢ Screen capture/recording      â”‚   â”‚
â”‚  â”‚ â€¢ Local backup to external          â€¢ Clipboard to personal device  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  CLOUD-BASED                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â€¢ SaaS app downloads                â€¢ API data extraction           â”‚   â”‚
â”‚  â”‚ â€¢ Shared links to external          â€¢ Cloud-to-cloud sync           â”‚   â”‚
â”‚  â”‚ â€¢ Personal account sync             â€¢ Shadow IT applications        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Network Exfiltration Detection</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Large Outbound Transfers</div>
                        <pre><code>// Detect unusually large outbound data transfers
CommonSecurityLog
| where TimeGenerated > ago(24h)
| where DeviceAction == "allow"
| where DestinationIP !startswith "10." 
    and DestinationIP !startswith "192.168."
    and DestinationIP !startswith "172."
| summarize 
    TotalBytesSent = sum(SentBytes),
    SessionCount = count(),
    UniqueDestinations = dcount(DestinationIP)
  by SourceIP, bin(TimeGenerated, 1h)
| where TotalBytesSent > 500000000  // > 500 MB
| order by TotalBytesSent desc</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">SPL: DNS Tunneling Detection</div>
                        <pre><code>index=dns query_type=TXT OR query_type=NULL
| eval query_length = len(query)
| eval subdomain_count = mvcount(split(query, "."))
| stats avg(query_length) as avg_len,
        max(query_length) as max_len,
        count as query_count,
        dc(query) as unique_queries
  by src_ip, query_domain
| where avg_len > 50 OR max_len > 100  // Long queries = possible tunneling
| where query_count > 100
| sort -avg_len</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Beaconing Detection</div>
                        <pre><code>// Detect regular beaconing patterns (C2 communication)
CommonSecurityLog
| where TimeGenerated > ago(24h)
| where DeviceAction == "allow"
| summarize 
    ConnectionTimes = make_list(TimeGenerated),
    ConnectionCount = count()
  by SourceIP, DestinationIP
| where ConnectionCount > 50
| extend Intervals = array_sort_asc(ConnectionTimes)
| mv-apply Intervals to typeof(datetime) on (
    extend NextTime = next(Intervals)
    | where isnotnull(NextTime)
    | extend IntervalSeconds = datetime_diff('second', NextTime, Intervals)
    | summarize 
        AvgInterval = avg(IntervalSeconds),
        StdDevInterval = stdev(IntervalSeconds)
)
| where StdDevInterval < 10  // Very regular intervals = beaconing
| project SourceIP, DestinationIP, ConnectionCount, AvgInterval, StdDevInterval</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Cloud Exfiltration Detection</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Bulk SharePoint Downloads</div>
                        <pre><code>OfficeActivity
| where TimeGenerated > ago(24h)
| where Operation == "FileDownloaded"
| where OfficeWorkload == "SharePoint" or OfficeWorkload == "OneDrive"
| summarize 
    DownloadCount = count(),
    UniqueFiles = dcount(SourceFileName),
    TotalSize = sum(tolong(ItemSize))
  by UserId, ClientIP, bin(TimeGenerated, 1h)
| where DownloadCount > 100 OR TotalSize > 100000000
| order by DownloadCount desc</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">KQL: External Sharing Anomaly</div>
                        <pre><code>OfficeActivity
| where TimeGenerated > ago(7d)
| where Operation in ("SharingSet", "AnonymousLinkCreated", "SecureLinkCreated")
| where TargetUserOrGroupType == "Guest" or Operation == "AnonymousLinkCreated"
| summarize 
    ShareCount = count(),
    UniqueFiles = dcount(SourceFileName),
    ExternalRecipients = make_set(TargetUserOrGroupName)
  by UserId
| join kind=leftouter (
    OfficeActivity
    | where TimeGenerated between (ago(37d) .. ago(7d))
    | where Operation in ("SharingSet", "AnonymousLinkCreated")
    | summarize BaselineShares = count() by UserId
) on UserId
| extend Anomaly = iff(ShareCount > coalesce(BaselineShares, 0) * 3, true, false)
| where Anomaly == true</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">SPL: Cloud Storage Upload Detection</div>
                        <pre><code>index=proxy 
| where url_domain IN ("dropbox.com", "drive.google.com", "onedrive.live.com", 
                       "box.com", "wetransfer.com", "mega.nz")
| where http_method=POST
| stats sum(bytes_out) as total_uploaded,
        count as upload_count,
        values(url_domain) as destinations
  by user, src_ip
| where total_uploaded > 50000000  // > 50 MB
| sort -total_uploaded</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Endpoint Exfiltration</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">KQL: USB Large File Transfers</div>
                        <pre><code>DeviceFileEvents
| where TimeGenerated > ago(24h)
| where ActionType == "FileCreated" or ActionType == "FileModified"
| where FolderPath matches regex @"^[D-Z]:\\"  // Removable drives
| where FolderPath !startswith "C:\\"
| summarize 
    FileCount = count(),
    TotalSize = sum(FileSize),
    FileTypes = make_set(tostring(split(FileName, ".")[-1]))
  by DeviceName, AccountName, bin(TimeGenerated, 1h)
| where FileCount > 50 OR TotalSize > 100000000
| order by TotalSize desc</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">SPL: Sensitive File Access Before Departure</div>
                        <pre><code>// Correlate file access with HR departure data
index=file_access action=read
| lookup hr_terminations user OUTPUT termination_date, last_work_day
| where isnotnull(termination_date)
| where _time > relative_time(termination_date, "-14d")
| where file_path LIKE "%confidential%" OR file_path LIKE "%restricted%"
| stats count as access_count,
        dc(file_path) as unique_files,
        values(file_path) as accessed_files
  by user, termination_date
| where access_count > 20
| sort -access_count</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Email Exfiltration</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Large Email Attachments to External</div>
                        <pre><code>EmailEvents
| where TimeGenerated > ago(24h)
| where EmailDirection == "Outbound"
| where RecipientEmailAddress !endswith "@company.com"
| join kind=inner (
    EmailAttachmentInfo
    | where TimeGenerated > ago(24h)
    | project NetworkMessageId, FileName, FileSize = FileSize
) on NetworkMessageId
| summarize 
    TotalAttachmentSize = sum(FileSize),
    AttachmentCount = count(),
    Recipients = make_set(RecipientEmailAddress)
  by SenderFromAddress, bin(TimeGenerated, 1h)
| where TotalAttachmentSize > 25000000  // > 25 MB
| order by TotalAttachmentSize desc</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Auto-Forward to External</div>
                        <pre><code>OfficeActivity
| where TimeGenerated > ago(7d)
| where Operation in ("Set-Mailbox", "New-InboxRule", "Set-InboxRule")
| where Parameters has "ForwardTo" or Parameters has "RedirectTo"
| extend RuleDetails = parse_json(Parameters)
| extend ForwardAddress = tostring(RuleDetails.ForwardTo)
| where ForwardAddress !endswith "@company.com"
| project TimeGenerated, UserId, Operation, ForwardAddress, ClientIP</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Exfiltration Indicators</h2>
                    
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Indicator</th>
                                    <th>Detection Method</th>
                                    <th>MITRE Technique</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Large outbound transfers</strong></td>
                                    <td>Bytes sent > baseline</td>
                                    <td>T1048 - Exfiltration Over Alternative Protocol</td>
                                </tr>
                                <tr>
                                    <td><strong>DNS tunneling</strong></td>
                                    <td>Long/encoded DNS queries</td>
                                    <td>T1048.003 - Exfiltration Over DNS</td>
                                </tr>
                                <tr>
                                    <td><strong>Cloud upload spike</strong></td>
                                    <td>Upload volume anomaly</td>
                                    <td>T1567 - Exfiltration to Cloud Storage</td>
                                </tr>
                                <tr>
                                    <td><strong>USB data copy</strong></td>
                                    <td>File writes to removable</td>
                                    <td>T1052 - Exfiltration Over Physical Medium</td>
                                </tr>
                                <tr>
                                    <td><strong>After-hours transfers</strong></td>
                                    <td>Data movement outside business hours</td>
                                    <td>T1029 - Scheduled Transfer</td>
                                </tr>
                                <tr>
                                    <td><strong>Compression before transfer</strong></td>
                                    <td>Archive creation + network activity</td>
                                    <td>T1560 - Archive Collected Data</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section class="content-section">
                    <div class="info-box interview">
                        <div class="info-box-title">ğŸ’¼ Interview Tip</div>
                        <p><strong>Q: "How do you detect data exfiltration?"</strong></p>
                        <p><strong>A:</strong> "Exfiltration detection requires monitoring multiple channels:</p>
                        <ol>
                            <li><strong>Baseline normal:</strong> First, I establish what's normal. How much data does each user/system typically transfer externally? Anomalies are only meaningful against baselines.</li>
                            <li><strong>Volume thresholds:</strong> Large outbound transfers trigger alerts. But attackers know thisâ€”so I also watch for many small transfers (low-and-slow exfil).</li>
                            <li><strong>Channel monitoring:</strong> I monitor all egress paths: web uploads, email attachments, cloud storage, DNS, removable media. Blocking one channel pushes attackers to another.</li>
                            <li><strong>Context correlation:</strong> Data transfer alone isn't suspicious. But data transfer + new external IP + after hours + recent sensitive file access = high confidence.</li>
                            <li><strong>User risk integration:</strong> Employees with resignation dates, under investigation, or with elevated access warrant extra monitoring.</li>
                            <li><strong>Protocol anomalies:</strong> DNS tunneling, ICMP exfil, steganographyâ€”these bypass volume-based detection. I look for protocol misuse patterns.</li>
                        </ol>
                        <p>The key is layering: no single detection catches everything, but multiple overlapping controls create coverage."</p>
                    </div>
                </section>

                <section class="content-section">
                    <div class="cheatsheet">
                        <div class="cheatsheet-title">ğŸ“‹ Exfiltration Detection Quick Reference</div>
                        <h4>High-Risk Indicators</h4>
                        <ul>
                            <li>> 100MB outbound in 1 hour</li>
                            <li>Transfers to new external IPs</li>
                            <li>After-hours data movement</li>
                            <li>Archive creation + transfer</li>
                            <li>Cloud storage uploads</li>
                            <li>USB activity on sensitive systems</li>
                        </ul>
                        <h4>Key Log Sources</h4>
                        <ul>
                            <li>Firewall/proxy (bytes out)</li>
                            <li>DLP (sensitive data movement)</li>
                            <li>EDR (file operations)</li>
                            <li>Cloud audit (SharePoint, O365)</li>
                            <li>Email gateway (attachments)</li>
                        </ul>
                        <h4>MITRE Exfiltration Techniques</h4>
                        <ul>
                            <li>T1041 - Exfil Over C2 Channel</li>
                            <li>T1048 - Exfil Over Alt Protocol</li>
                            <li>T1567 - Exfil to Cloud Storage</li>
                            <li>T1052 - Exfil Over Physical</li>
                        </ul>
                    </div>
                </section>

                <div style="display: flex; justify-content: space-between; margin-top: var(--spacing-2xl); padding-top: var(--spacing-lg); border-top: 1px solid var(--border-default);">
                    <a href="dlp-monitoring.html" class="card-link">â† DLP Monitoring</a>
                    <a href="insider-threats.html" class="card-link">Insider Threats â†’</a>
                </div>
            </div>
        </main>
    </div>
    <script src="main.js"></script>
</body>
</html>
