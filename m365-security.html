<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M365 Security Monitoring | SIEM Consultant Portfolio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <button class="mobile-menu-toggle" aria-label="Toggle navigation"><span></span></button>
    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" style="text-decoration: none; color: inherit;">
                    <div class="sidebar-logo"><div class="sidebar-logo-icon">âš¡</div>SIEM Consultant</div>
                </a>
                <div class="sidebar-subtitle">Knowledge Portfolio</div>
            </div>
                        <nav class="sidebar-nav">
                <!-- Foundation -->
                <div class="nav-section">
                    <div class="nav-section-title">Foundation</div>
                    <a href="index.html" class="nav-item">Home</a>
                    <a href="approach.html" class="nav-item">Consulting Approach</a>
                    <a href="deliverables.html" class="nav-item">Project Deliverables</a>
                    <a href="experience.html" class="nav-item">Experience</a>
                </div>
                
                <!-- SIEM Fundamentals -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Fundamentals</div>
                    <a href="what-is-siem.html" class="nav-item">What is SIEM?</a>
                    <a href="siem-architecture.html" class="nav-item">SIEM Architecture</a>
                    <a href="siem-data-flow.html" class="nav-item">SIEM Data Flow</a>
                    <a href="platform-comparison.html" class="nav-item">Platform Comparison</a>
                    <a href="siem-metrics.html" class="nav-item">SIEM Metrics</a>
                    <a href="siem-health.html" class="nav-item">SIEM Health</a>
                    <a href="siem-rfp.html" class="nav-item">SIEM RFP Guide</a>
                    <a href="security-data-lake.html" class="nav-item">Security Data Lake</a>
                </div>
                
                <!-- SIEM Platforms -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Platforms</div>
                    <a href="splunk-overview.html" class="nav-item">Splunk Overview</a>
                    <a href="splunk-cloud.html" class="nav-item">Splunk Cloud</a>
                    <a href="splunk-hybrid.html" class="nav-item">Splunk Hybrid</a>
                    <a href="sentinel-overview.html" class="nav-item">Microsoft Sentinel</a>
                </div>
                
                <!-- Log Sources -->
                <div class="nav-section">
                    <div class="nav-section-title">Log Sources</div>
                    <a href="log-sources-overview.html" class="nav-item">Log Sources Overview</a>
                    <a href="windows-logs.html" class="nav-item">Windows Logs</a>
                    <a href="linux-logs.html" class="nav-item">Linux Logs</a>
                    <a href="network-logs.html" class="nav-item">Network Logs</a>
                    <a href="cloud-logs.html" class="nav-item">Cloud Logs</a>
                    <a href="endpoint-logs.html" class="nav-item">Endpoint Logs</a>
                    <a href="identity-logs.html" class="nav-item">Identity Logs</a>
                    <a href="application-logs.html" class="nav-item">Application Logs</a>
                </div>
                
                <!-- Log Engineering -->
                <div class="nav-section">
                    <div class="nav-section-title">Log Engineering</div>
                    <a href="log-pipeline.html" class="nav-item">Log Pipeline</a>
                    <a href="log-parsing.html" class="nav-item">Log Parsing</a>
                    <a href="log-retention.html" class="nav-item">Log Retention</a>
                </div>
                
                <!-- SIEM Migrations -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Migrations</div>
                    <a href="migration-methodology.html" class="nav-item">Migration Methodology</a>
                    <a href="discovery-assessment.html" class="nav-item">Discovery & Assessment</a>
                    <a href="log-migration.html" class="nav-item">Log Migration</a>
                    <a href="detection-migration.html" class="nav-item">Detection Migration</a>
                    <a href="query-translation.html" class="nav-item">Query Translation</a>
                </div>
                
                <!-- Detection Engineering -->
                <div class="nav-section">
                    <div class="nav-section-title">Detection Engineering</div>
                    <a href="detection-fundamentals.html" class="nav-item">Detection Fundamentals</a>
                    <a href="use-case-development.html" class="nav-item">Use Case Development</a>
                    <a href="tuning-methodology.html" class="nav-item">Tuning Methodology</a>
                    <a href="sigma-rules.html" class="nav-item">Sigma Rules</a>
                    <a href="alert-enrichment.html" class="nav-item">Alert Enrichment</a>
                    <a href="alert-fatigue.html" class="nav-item">Alert Fatigue</a>
                </div>
                
                <!-- Threat Detection -->
                <div class="nav-section">
                    <div class="nav-section-title">Threat Detection</div>
                    <a href="mitre-attack-intro.html" class="nav-item">MITRE ATT&CK</a>
                    <a href="threat-modeling.html" class="nav-item">Threat Modeling</a>
                    <a href="threat-intelligence.html" class="nav-item">Threat Intelligence</a>
                    <a href="threat-hunting.html" class="nav-item">Threat Hunting</a>
                    <a href="ueba-analytics.html" class="nav-item">UEBA Analytics</a>
                </div>
                
                <!-- Query Languages -->
                <div class="nav-section">
                    <div class="nav-section-title">Query Languages</div>
                    <a href="spl-fundamentals.html" class="nav-item">SPL Fundamentals</a>
                    <a href="kql-fundamentals.html" class="nav-item">KQL Fundamentals</a>
                </div>
                
                <!-- Windows Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Windows Security</div>
                    <a href="sysmon-config.html" class="nav-item">Sysmon Configuration</a>
                    <a href="windows-attack-techniques.html" class="nav-item">Windows Attacks</a>
                    <a href="windows-hardening.html" class="nav-item">Windows Hardening</a>
                    <a href="powershell-security.html" class="nav-item">PowerShell Security</a>
                </div>
                
                <!-- Cloud Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Cloud Security</div>
                    <a href="cloud-security-monitoring.html" class="nav-item">Cloud Monitoring</a>
                    <a href="azure-security.html" class="nav-item">Azure Security</a>
                    <a href="aws-security.html" class="nav-item">AWS Security</a>
                    <a href="gcp-security.html" class="nav-item">GCP Security</a>
                    <a href="m365-security.html" class="nav-item active">M365 Security</a>
                    <a href="container-security.html" class="nav-item">Container Security</a>
                </div>
                
                <!-- Network Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Network Security</div>
                    <a href="network-security-monitoring.html" class="nav-item">Network Monitoring</a>
                    <a href="dns-security.html" class="nav-item">DNS Security</a>
                    <a href="zero-trust.html" class="nav-item">Zero Trust</a>
                </div>
                
                <!-- Identity Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Identity Security</div>
                    <a href="identity-security.html" class="nav-item">Identity Security</a>
                    <a href="active-directory.html" class="nav-item">Active Directory</a>
                </div>
                
                <!-- Data Protection -->
                <div class="nav-section">
                    <div class="nav-section-title">Data Protection</div>
                    <a href="dlp-monitoring.html" class="nav-item">DLP Monitoring</a>
                    <a href="data-classification.html" class="nav-item">Data Classification</a>
                    <a href="data-exfiltration.html" class="nav-item">Data Exfiltration</a>
                    <a href="insider-threats.html" class="nav-item">Insider Threats</a>
                </div>
                
                <!-- Specific Threats -->
                <div class="nav-section">
                    <div class="nav-section-title">Threat Scenarios</div>
                    <a href="phishing-detection.html" class="nav-item">Phishing Detection</a>
                    <a href="ransomware-detection.html" class="nav-item">Ransomware Detection</a>
                    <a href="email-security.html" class="nav-item">Email Security</a>
                </div>
                
                <!-- SOC Operations -->
                <div class="nav-section">
                    <div class="nav-section-title">SOC Operations</div>
                    <a href="soc-operations.html" class="nav-item">SOC Operations</a>
                    <a href="incident-response.html" class="nav-item">Incident Response</a>
                    <a href="incident-metrics.html" class="nav-item">Incident Metrics</a>
                    <a href="case-management.html" class="nav-item">Case Management</a>
                    <a href="dashboard-design.html" class="nav-item">Dashboard Design</a>
                    <a href="runbook-development.html" class="nav-item">Runbook Development</a>
                </div>
                
                <!-- Automation -->
                <div class="nav-section">
                    <div class="nav-section-title">Automation</div>
                    <a href="soar-automation.html" class="nav-item">SOAR Automation</a>
                    <a href="security-playbooks.html" class="nav-item">Security Playbooks</a>
                    <a href="python-security.html" class="nav-item">Python for Security</a>
                </div>
                
                <!-- Integrations -->
                <div class="nav-section">
                    <div class="nav-section-title">Integrations</div>
                    <a href="edr-integration.html" class="nav-item">EDR Integration</a>
                    <a href="vulnerability-management.html" class="nav-item">Vulnerability Mgmt</a>
                    <a href="api-security.html" class="nav-item">API Security</a>
                </div>
                
                <!-- Operations -->
                <div class="nav-section">
                    <div class="nav-section-title">Operations</div>
                    <a href="performance-optimization.html" class="nav-item">Performance</a>
                    <a href="cost-optimization.html" class="nav-item">Cost Optimization</a>
                    <a href="compliance-governance.html" class="nav-item">Compliance</a>
                </div>
                
                <!-- Interview Prep -->
                <div class="nav-section">
                    <div class="nav-section-title">Interview Prep</div>
                    <a href="interview-strategy.html" class="nav-item">â­ Interview Strategy</a>
                    <a href="common-questions.html" class="nav-item">Common Questions</a>
                    <a href="interview-scenarios.html" class="nav-item">Scenarios</a>
                </div>
            </nav>
        </aside>
        <main class="main-content">
            <div class="content-wrapper">
                <nav class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-current">M365 Security</span>
                </nav>

                <header class="page-header">
                    <h1 class="page-title">Microsoft 365 Security Monitoring</h1>
                    <p class="page-subtitle">Microsoft 365 is the backbone of enterprise productivityâ€”and a prime target for attackers. Comprehensive monitoring of Entra ID, Exchange, SharePoint, and Teams is essential for detecting compromise.</p>
                </header>

                <section class="content-section">
                    <h2>M365 Security Architecture</h2>
                    
                    <div class="diagram">
                        <div class="diagram-title">M365 Security Log Sources</div>
                        <pre><code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MICROSOFT 365 SECURITY MONITORING                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  IDENTITY (Entra ID)              PRODUCTIVITY                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ â€¢ Sign-in logs      â”‚         â”‚ Exchange Online             â”‚           â”‚
â”‚  â”‚ â€¢ Audit logs        â”‚         â”‚ â€¢ Mail flow, phishing       â”‚           â”‚
â”‚  â”‚ â€¢ Risky users/signs â”‚         â”‚ â€¢ Inbox rules, forwarding   â”‚           â”‚
â”‚  â”‚ â€¢ MFA events        â”‚         â”‚                             â”‚           â”‚
â”‚  â”‚ â€¢ Conditional Accessâ”‚         â”‚ SharePoint/OneDrive         â”‚           â”‚
â”‚  â”‚ â€¢ App registrations â”‚         â”‚ â€¢ File access, sharing      â”‚           â”‚
â”‚  â”‚ â€¢ Role changes      â”‚         â”‚ â€¢ External collaboration    â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚                             â”‚           â”‚
â”‚                                  â”‚ Teams                       â”‚           â”‚
â”‚  SECURITY                        â”‚ â€¢ Channel creation          â”‚           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚ â€¢ Guest access              â”‚           â”‚
â”‚  â”‚ â€¢ Defender alerts   â”‚         â”‚ â€¢ App installations         â”‚           â”‚
â”‚  â”‚ â€¢ Safe Links clicks â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚  â”‚ â€¢ Safe Attachments  â”‚                                                   â”‚
â”‚  â”‚ â€¢ DLP matches       â”‚         ADMIN                                     â”‚
â”‚  â”‚ â€¢ Cloud App Securityâ”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ â€¢ Admin audit log           â”‚           â”‚
â”‚                                  â”‚ â€¢ PowerShell sessions       â”‚           â”‚
â”‚                                  â”‚ â€¢ Exchange admin            â”‚           â”‚
â”‚                                  â”‚ â€¢ SharePoint admin          â”‚           â”‚
â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Entra ID Monitoring</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Suspicious Sign-In Patterns</div>
                        <pre><code>SigninLogs
| where TimeGenerated > ago(24h)
| where ResultType != 0  // Failed sign-ins
| summarize 
    FailureCount = count(),
    FailureReasons = make_set(ResultDescription),
    UniqueIPs = dcount(IPAddress),
    Countries = make_set(LocationDetails.countryOrRegion)
  by UserPrincipalName
| where FailureCount > 10 OR UniqueIPs > 5
| order by FailureCount desc</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Impossible Travel Detection</div>
                        <pre><code>SigninLogs
| where TimeGenerated > ago(24h)
| where ResultType == 0
| project TimeGenerated, UserPrincipalName, IPAddress,
          City = tostring(LocationDetails.city),
          Country = tostring(LocationDetails.countryOrRegion)
| sort by UserPrincipalName, TimeGenerated asc
| extend PrevTime = prev(TimeGenerated),
         PrevCity = prev(City),
         PrevCountry = prev(Country),
         PrevUser = prev(UserPrincipalName)
| where UserPrincipalName == PrevUser
| extend TimeDiffMinutes = datetime_diff('minute', TimeGenerated, PrevTime)
| where TimeDiffMinutes < 60 and Country != PrevCountry
| project TimeGenerated, UserPrincipalName, 
          FromLocation = strcat(PrevCity, ", ", PrevCountry),
          ToLocation = strcat(City, ", ", Country),
          TimeDiffMinutes</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Privileged Role Changes</div>
                        <pre><code>AuditLogs
| where TimeGenerated > ago(7d)
| where OperationName has "Add member to role"
| where TargetResources[0].modifiedProperties[1].newValue has_any 
    ("Global Administrator", "Exchange Administrator", 
     "Security Administrator", "Privileged Role Administrator")
| extend Actor = InitiatedBy.user.userPrincipalName
| extend Target = TargetResources[0].userPrincipalName
| extend Role = tostring(TargetResources[0].modifiedProperties[1].newValue)
| project TimeGenerated, Actor, Target, Role, OperationName</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Exchange Online Security</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Suspicious Inbox Rules</div>
                        <pre><code>OfficeActivity
| where TimeGenerated > ago(7d)
| where Operation in ("New-InboxRule", "Set-InboxRule")
| extend RuleParams = parse_json(Parameters)
| extend RuleName = tostring(RuleParams[0].Value)
| where RuleParams has "DeleteMessage" 
     or RuleParams has "ForwardTo" 
     or RuleParams has "RedirectTo"
| extend ForwardTo = extract(@"ForwardTo['""]?:\s*['""]?([^'""}\]]+)", 1, tostring(RuleParams))
| project TimeGenerated, UserId, RuleName, Operation, ForwardTo, ClientIP
| where isnotempty(ForwardTo)</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Email Forwarding Rules</div>
                        <pre><code>OfficeActivity
| where TimeGenerated > ago(7d)
| where Operation == "Set-Mailbox"
| where Parameters has "ForwardingSmtpAddress" or Parameters has "ForwardingAddress"
| extend Params = parse_json(Parameters)
| mv-expand Params
| where Params.Name in ("ForwardingSmtpAddress", "ForwardingAddress")
| extend ForwardTo = tostring(Params.Value)
| where isnotempty(ForwardTo) and ForwardTo != "null"
| project TimeGenerated, UserId, ForwardTo, ClientIP, UserAgent</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>SharePoint & OneDrive</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Mass File Downloads</div>
                        <pre><code>OfficeActivity
| where TimeGenerated > ago(24h)
| where OfficeWorkload in ("SharePoint", "OneDrive")
| where Operation == "FileDownloaded"
| summarize 
    DownloadCount = count(),
    UniqueFiles = dcount(SourceFileName),
    Sites = make_set(Site_Url, 5)
  by UserId, ClientIP, bin(TimeGenerated, 1h)
| where DownloadCount > 50
| order by DownloadCount desc</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">KQL: External Sharing Detection</div>
                        <pre><code>OfficeActivity
| where TimeGenerated > ago(7d)
| where OfficeWorkload == "SharePoint"
| where Operation in ("SharingSet", "AnonymousLinkCreated", 
                      "CompanyLinkCreated", "SecureLinkCreated")
| where TargetUserOrGroupType == "Guest" 
     or Operation == "AnonymousLinkCreated"
| extend SharedWith = TargetUserOrGroupName
| extend FileName = SourceFileName
| project TimeGenerated, UserId, Operation, FileName, 
          SharedWith, Site_Url, ClientIP
| order by TimeGenerated desc</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>OAuth & App Permissions</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Risky OAuth Consent</div>
                        <pre><code>AuditLogs
| where TimeGenerated > ago(7d)
| where OperationName == "Consent to application"
| extend AppName = TargetResources[0].displayName
| extend Permissions = TargetResources[0].modifiedProperties
| mv-expand Permissions
| where Permissions.displayName == "ConsentAction.Permissions"
| extend GrantedPermissions = tostring(Permissions.newValue)
| where GrantedPermissions has_any ("Mail.Read", "Mail.Send", 
        "Files.ReadWrite", "Directory.ReadWrite", "User.ReadWrite.All")
| extend UserWhoConsented = InitiatedBy.user.userPrincipalName
| project TimeGenerated, UserWhoConsented, AppName, GrantedPermissions</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">KQL: New App Registrations</div>
                        <pre><code>AuditLogs
| where TimeGenerated > ago(7d)
| where OperationName == "Add application"
| extend Actor = InitiatedBy.user.userPrincipalName
| extend AppName = TargetResources[0].displayName
| extend AppId = TargetResources[0].id
| project TimeGenerated, Actor, AppName, AppId, CorrelationId</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Key Detection Scenarios</h2>
                    
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Threat</th>
                                    <th>Detection</th>
                                    <th>M365 Log Source</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Account Takeover</strong></td>
                                    <td>Impossible travel, new device, password change</td>
                                    <td>SigninLogs, AuditLogs</td>
                                </tr>
                                <tr>
                                    <td><strong>BEC</strong></td>
                                    <td>Inbox rules, mail forwarding, impersonation</td>
                                    <td>OfficeActivity, EmailEvents</td>
                                </tr>
                                <tr>
                                    <td><strong>Data Exfiltration</strong></td>
                                    <td>Mass downloads, external sharing</td>
                                    <td>OfficeActivity</td>
                                </tr>
                                <tr>
                                    <td><strong>Privilege Escalation</strong></td>
                                    <td>Role assignments, group changes</td>
                                    <td>AuditLogs</td>
                                </tr>
                                <tr>
                                    <td><strong>OAuth Phishing</strong></td>
                                    <td>Suspicious app consent</td>
                                    <td>AuditLogs</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section class="content-section">
                    <div class="info-box interview">
                        <div class="info-box-title">ğŸ’¼ Interview Tip</div>
                        <p><strong>Q: "What are the key M365 security events to monitor?"</strong></p>
                        <p><strong>A:</strong> "M365 monitoring focuses on identity, data, and configuration:</p>
                        <ol>
                            <li><strong>Identity attacks:</strong> SigninLogs for failed logins, impossible travel, new devices. These indicate credential compromise or brute force.</li>
                            <li><strong>BEC indicators:</strong> Inbox rules that delete or forward mail, especially with financial keywords. Email forwarding to external addresses. Reply-to manipulation.</li>
                            <li><strong>Data exposure:</strong> SharePoint/OneDrive external sharing, especially anonymous links. Mass file downloads suggesting exfiltration.</li>
                            <li><strong>Privilege changes:</strong> AuditLogs for role assignments, especially Global Admin or Exchange Admin. These should be rare and approved.</li>
                            <li><strong>OAuth abuse:</strong> Application consent events, especially for apps requesting Mail.Read, Mail.Send, or Files.ReadWrite. Consent phishing is common.</li>
                            <li><strong>Admin activity:</strong> PowerShell sessions, Exchange admin commands, especially from unexpected IPs or users.</li>
                        </ol>
                        <p>The unified audit log in M365 captures most of this, but you need to know what to look for."</p>
                    </div>
                </section>

                <section class="content-section">
                    <div class="cheatsheet">
                        <div class="cheatsheet-title">ğŸ“‹ M365 Monitoring Quick Reference</div>
                        <h4>Critical Tables</h4>
                        <ul>
                            <li>SigninLogs - Authentication</li>
                            <li>AuditLogs - Admin/config changes</li>
                            <li>OfficeActivity - User activity</li>
                            <li>EmailEvents - Mail telemetry</li>
                            <li>CloudAppEvents - MCAS</li>
                        </ul>
                        <h4>High-Risk Operations</h4>
                        <ul>
                            <li>New-InboxRule (forwarding)</li>
                            <li>Set-Mailbox (forwarding)</li>
                            <li>Add member to role</li>
                            <li>Consent to application</li>
                            <li>AnonymousLinkCreated</li>
                        </ul>
                        <h4>Key Sign-In Signals</h4>
                        <ul>
                            <li>ResultType != 0 (failures)</li>
                            <li>RiskLevel (Identity Protection)</li>
                            <li>MfaDetail (MFA bypass)</li>
                            <li>DeviceDetail (new devices)</li>
                        </ul>
                    </div>
                </section>

                <div style="display: flex; justify-content: space-between; margin-top: var(--spacing-2xl); padding-top: var(--spacing-lg); border-top: 1px solid var(--border-default);">
                    <a href="cloud-security-monitoring.html" class="card-link">â† Cloud Security</a>
                    <a href="azure-security.html" class="card-link">Azure Security â†’</a>
                </div>
            </div>
        </main>
    </div>
    <script src="main.js"></script>
</body>
</html>
