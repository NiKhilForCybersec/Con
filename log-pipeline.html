<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Log Pipeline Architecture | SIEM Consultant Portfolio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <button class="mobile-menu-toggle" aria-label="Toggle navigation"><span></span></button>
    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" style="text-decoration: none; color: inherit;">
                    <div class="sidebar-logo"><div class="sidebar-logo-icon">âš¡</div>SIEM Consultant</div>
                </a>
                <div class="sidebar-subtitle">Knowledge Portfolio</div>
            </div>
                        <nav class="sidebar-nav">
                <!-- Foundation -->
                <div class="nav-section">
                    <div class="nav-section-title">Foundation</div>
                    <a href="index.html" class="nav-item">Home</a>
                    <a href="approach.html" class="nav-item">Consulting Approach</a>
                    <a href="deliverables.html" class="nav-item">Project Deliverables</a>
                    <a href="experience.html" class="nav-item">Experience</a>
                </div>
                
                <!-- SIEM Fundamentals -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Fundamentals</div>
                    <a href="what-is-siem.html" class="nav-item">What is SIEM?</a>
                    <a href="siem-architecture.html" class="nav-item">SIEM Architecture</a>
                    <a href="siem-data-flow.html" class="nav-item">SIEM Data Flow</a>
                    <a href="platform-comparison.html" class="nav-item">Platform Comparison</a>
                    <a href="siem-metrics.html" class="nav-item">SIEM Metrics</a>
                    <a href="siem-health.html" class="nav-item">SIEM Health</a>
                    <a href="siem-rfp.html" class="nav-item">SIEM RFP Guide</a>
                    <a href="security-data-lake.html" class="nav-item">Security Data Lake</a>
                </div>
                
                <!-- SIEM Platforms -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Platforms</div>
                    <a href="splunk-overview.html" class="nav-item">Splunk Overview</a>
                    <a href="splunk-cloud.html" class="nav-item">Splunk Cloud</a>
                    <a href="splunk-hybrid.html" class="nav-item">Splunk Hybrid</a>
                    <a href="sentinel-overview.html" class="nav-item">Microsoft Sentinel</a>
                </div>
                
                <!-- Log Sources -->
                <div class="nav-section">
                    <div class="nav-section-title">Log Sources</div>
                    <a href="log-sources-overview.html" class="nav-item">Log Sources Overview</a>
                    <a href="windows-logs.html" class="nav-item">Windows Logs</a>
                    <a href="linux-logs.html" class="nav-item">Linux Logs</a>
                    <a href="network-logs.html" class="nav-item">Network Logs</a>
                    <a href="cloud-logs.html" class="nav-item">Cloud Logs</a>
                    <a href="endpoint-logs.html" class="nav-item">Endpoint Logs</a>
                    <a href="identity-logs.html" class="nav-item">Identity Logs</a>
                    <a href="application-logs.html" class="nav-item">Application Logs</a>
                </div>
                
                <!-- Log Engineering -->
                <div class="nav-section">
                    <div class="nav-section-title">Log Engineering</div>
                    <a href="log-pipeline.html" class="nav-item active">Log Pipeline</a>
                    <a href="log-parsing.html" class="nav-item">Log Parsing</a>
                    <a href="log-retention.html" class="nav-item">Log Retention</a>
                </div>
                
                <!-- SIEM Migrations -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Migrations</div>
                    <a href="migration-methodology.html" class="nav-item">Migration Methodology</a>
                    <a href="discovery-assessment.html" class="nav-item">Discovery & Assessment</a>
                    <a href="log-migration.html" class="nav-item">Log Migration</a>
                    <a href="detection-migration.html" class="nav-item">Detection Migration</a>
                    <a href="query-translation.html" class="nav-item">Query Translation</a>
                </div>
                
                <!-- Detection Engineering -->
                <div class="nav-section">
                    <div class="nav-section-title">Detection Engineering</div>
                    <a href="detection-fundamentals.html" class="nav-item">Detection Fundamentals</a>
                    <a href="use-case-development.html" class="nav-item">Use Case Development</a>
                    <a href="tuning-methodology.html" class="nav-item">Tuning Methodology</a>
                    <a href="sigma-rules.html" class="nav-item">Sigma Rules</a>
                    <a href="alert-enrichment.html" class="nav-item">Alert Enrichment</a>
                    <a href="alert-fatigue.html" class="nav-item">Alert Fatigue</a>
                </div>
                
                <!-- Threat Detection -->
                <div class="nav-section">
                    <div class="nav-section-title">Threat Detection</div>
                    <a href="mitre-attack-intro.html" class="nav-item">MITRE ATT&CK</a>
                    <a href="threat-modeling.html" class="nav-item">Threat Modeling</a>
                    <a href="threat-intelligence.html" class="nav-item">Threat Intelligence</a>
                    <a href="threat-hunting.html" class="nav-item">Threat Hunting</a>
                    <a href="ueba-analytics.html" class="nav-item">UEBA Analytics</a>
                </div>
                
                <!-- Query Languages -->
                <div class="nav-section">
                    <div class="nav-section-title">Query Languages</div>
                    <a href="spl-fundamentals.html" class="nav-item">SPL Fundamentals</a>
                    <a href="kql-fundamentals.html" class="nav-item">KQL Fundamentals</a>
                </div>
                
                <!-- Windows Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Windows Security</div>
                    <a href="sysmon-config.html" class="nav-item">Sysmon Configuration</a>
                    <a href="windows-attack-techniques.html" class="nav-item">Windows Attacks</a>
                    <a href="windows-hardening.html" class="nav-item">Windows Hardening</a>
                    <a href="powershell-security.html" class="nav-item">PowerShell Security</a>
                </div>
                
                <!-- Cloud Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Cloud Security</div>
                    <a href="cloud-security-monitoring.html" class="nav-item">Cloud Monitoring</a>
                    <a href="azure-security.html" class="nav-item">Azure Security</a>
                    <a href="aws-security.html" class="nav-item">AWS Security</a>
                    <a href="gcp-security.html" class="nav-item">GCP Security</a>
                    <a href="m365-security.html" class="nav-item">M365 Security</a>
                    <a href="container-security.html" class="nav-item">Container Security</a>
                </div>
                
                <!-- Network Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Network Security</div>
                    <a href="network-security-monitoring.html" class="nav-item">Network Monitoring</a>
                    <a href="dns-security.html" class="nav-item">DNS Security</a>
                    <a href="zero-trust.html" class="nav-item">Zero Trust</a>
                </div>
                
                <!-- Identity Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Identity Security</div>
                    <a href="identity-security.html" class="nav-item">Identity Security</a>
                    <a href="active-directory.html" class="nav-item">Active Directory</a>
                </div>
                
                <!-- Data Protection -->
                <div class="nav-section">
                    <div class="nav-section-title">Data Protection</div>
                    <a href="dlp-monitoring.html" class="nav-item">DLP Monitoring</a>
                    <a href="data-classification.html" class="nav-item">Data Classification</a>
                    <a href="data-exfiltration.html" class="nav-item">Data Exfiltration</a>
                    <a href="insider-threats.html" class="nav-item">Insider Threats</a>
                </div>
                
                <!-- Specific Threats -->
                <div class="nav-section">
                    <div class="nav-section-title">Threat Scenarios</div>
                    <a href="phishing-detection.html" class="nav-item">Phishing Detection</a>
                    <a href="ransomware-detection.html" class="nav-item">Ransomware Detection</a>
                    <a href="email-security.html" class="nav-item">Email Security</a>
                </div>
                
                <!-- SOC Operations -->
                <div class="nav-section">
                    <div class="nav-section-title">SOC Operations</div>
                    <a href="soc-operations.html" class="nav-item">SOC Operations</a>
                    <a href="incident-response.html" class="nav-item">Incident Response</a>
                    <a href="incident-metrics.html" class="nav-item">Incident Metrics</a>
                    <a href="case-management.html" class="nav-item">Case Management</a>
                    <a href="dashboard-design.html" class="nav-item">Dashboard Design</a>
                    <a href="runbook-development.html" class="nav-item">Runbook Development</a>
                </div>
                
                <!-- Automation -->
                <div class="nav-section">
                    <div class="nav-section-title">Automation</div>
                    <a href="soar-automation.html" class="nav-item">SOAR Automation</a>
                    <a href="security-playbooks.html" class="nav-item">Security Playbooks</a>
                    <a href="python-security.html" class="nav-item">Python for Security</a>
                </div>
                
                <!-- Integrations -->
                <div class="nav-section">
                    <div class="nav-section-title">Integrations</div>
                    <a href="edr-integration.html" class="nav-item">EDR Integration</a>
                    <a href="vulnerability-management.html" class="nav-item">Vulnerability Mgmt</a>
                    <a href="api-security.html" class="nav-item">API Security</a>
                </div>
                
                <!-- Operations -->
                <div class="nav-section">
                    <div class="nav-section-title">Operations</div>
                    <a href="performance-optimization.html" class="nav-item">Performance</a>
                    <a href="cost-optimization.html" class="nav-item">Cost Optimization</a>
                    <a href="compliance-governance.html" class="nav-item">Compliance</a>
                </div>
                
                <!-- Interview Prep -->
                <div class="nav-section">
                    <div class="nav-section-title">Interview Prep</div>
                    <a href="interview-strategy.html" class="nav-item">â­ Interview Strategy</a>
                    <a href="common-questions.html" class="nav-item">Common Questions</a>
                    <a href="interview-scenarios.html" class="nav-item">Scenarios</a>
                </div>
            </nav>
        </aside>
        <main class="main-content">
            <div class="content-wrapper">
                <nav class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="breadcrumb-separator">/</span>
                    <a href="siem-architecture.html">Architecture</a>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-current">Log Pipeline</span>
                </nav>

                <header class="page-header">
                    <h1 class="page-title">Log Pipeline Architecture</h1>
                    <p class="page-subtitle">Modern log pipelines do more than transport data. They collect, parse, enrich, filter, and route logs for optimal SIEM performance and cost efficiency.</p>
                </header>

                <section class="content-section">
                    <h2>Pipeline Components</h2>
                    
                    <div class="diagram">
                        <div class="diagram-title">Enterprise Log Pipeline</div>
                        <pre><code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        LOG PIPELINE ARCHITECTURE                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  SOURCES                COLLECTION              PROCESSING                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ Windows  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Agents   â”‚           â”‚   PARSING    â”‚             â”‚
â”‚  â”‚ Linux    â”‚          â”‚ (Beats,  â”‚           â”‚ â€¢ Extract    â”‚             â”‚
â”‚  â”‚ Network  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Fluentd, â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   fields     â”‚             â”‚
â”‚  â”‚ Cloud    â”‚          â”‚ Splunk   â”‚           â”‚ â€¢ Normalize  â”‚             â”‚
â”‚  â”‚ Apps     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ UF, AMA) â”‚           â”‚   timestamps â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                      â”‚                      â”‚
â”‚                                                      â–¼                      â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚                        â”‚ Syslog   â”‚           â”‚  ENRICHMENT  â”‚             â”‚
â”‚                        â”‚ Servers  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ â€¢ GeoIP      â”‚             â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â€¢ Threat     â”‚             â”‚
â”‚                                               â”‚   intel      â”‚             â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚ â€¢ Asset      â”‚             â”‚
â”‚                        â”‚ API      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   context    â”‚             â”‚
â”‚                        â”‚ Polling  â”‚           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚                      â”‚
â”‚                                                      â–¼                      â”‚
â”‚                                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  ROUTING                                      â”‚   FILTERING  â”‚             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â€¢ Drop noise â”‚             â”‚
â”‚  â”‚                                          â”‚â”‚ â€¢ Sampling   â”‚             â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚â”‚ â€¢ Route      â”‚             â”‚
â”‚  â”‚  â”‚  SIEM  â”‚  â”‚  Lake  â”‚  â”‚Archive â”‚    â”‚â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚  â”‚  â”‚ (Hot)  â”‚  â”‚ (Warm) â”‚  â”‚ (Cold) â”‚    â”‚       â”‚                      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚â—„â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚  â”‚  Real-time   Ad-hoc      Compliance    â”‚                              â”‚
â”‚  â”‚  detection   hunting     retention     â”‚                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Collection Methods</h2>
                    
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Method</th>
                                    <th>Use Case</th>
                                    <th>Pros</th>
                                    <th>Cons</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Agent-Based</strong></td>
                                    <td>Endpoints, servers</td>
                                    <td>Reliable, can filter at source, encryption</td>
                                    <td>Requires deployment, resource usage</td>
                                </tr>
                                <tr>
                                    <td><strong>Syslog</strong></td>
                                    <td>Network devices, Linux</td>
                                    <td>Universal, no agent needed</td>
                                    <td>UDP unreliable, limited metadata</td>
                                </tr>
                                <tr>
                                    <td><strong>API Polling</strong></td>
                                    <td>SaaS, cloud services</td>
                                    <td>Native integration, rich data</td>
                                    <td>Rate limits, latency</td>
                                </tr>
                                <tr>
                                    <td><strong>Webhook/Push</strong></td>
                                    <td>Cloud events, apps</td>
                                    <td>Real-time, efficient</td>
                                    <td>Requires endpoint exposure</td>
                                </tr>
                                <tr>
                                    <td><strong>Database Query</strong></td>
                                    <td>Database audit logs</td>
                                    <td>Direct access</td>
                                    <td>Performance impact, complexity</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>Agent Comparison</h3>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Agent</th>
                                    <th>Vendor</th>
                                    <th>Best For</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Universal Forwarder</strong></td>
                                    <td>Splunk</td>
                                    <td>Splunk deployments, robust features</td>
                                </tr>
                                <tr>
                                    <td><strong>Azure Monitor Agent</strong></td>
                                    <td>Microsoft</td>
                                    <td>Azure/Sentinel, Windows/Linux</td>
                                </tr>
                                <tr>
                                    <td><strong>Elastic Agent</strong></td>
                                    <td>Elastic</td>
                                    <td>Elastic stack, unified agent</td>
                                </tr>
                                <tr>
                                    <td><strong>Fluentd/Fluent Bit</strong></td>
                                    <td>CNCF</td>
                                    <td>Cloud-native, Kubernetes</td>
                                </tr>
                                <tr>
                                    <td><strong>Cribl Edge</strong></td>
                                    <td>Cribl</td>
                                    <td>Edge processing, multi-destination</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Processing Layer</h2>
                    
                    <h3>Parsing & Normalization</h3>
                    <div class="info-box tip">
                        <div class="info-box-title">Cribl: Field Extraction</div>
                        <pre><code>// Extract fields from raw syslog
filter: sourcetype=='syslog'
final: true
functions:
  - id: regex_extract
    filter: "true"
    description: Extract CEF fields
    regex: /CEF:(?<cef_version>\d+)\|(?<device_vendor>[^|]+)\|(?<device_product>[^|]+)\|(?<device_version>[^|]+)\|(?<signature_id>[^|]+)\|(?<name>[^|]+)\|(?<severity>[^|]+)\|(?<extension>.*)/
    
  - id: rename
    currentName: host
    newName: src_host

  - id: eval
    add:
      - name: timestamp
        value: Date.now() / 1000</code></pre>
                    </div>

                    <h3>Enrichment</h3>
                    <div class="info-box tip">
                        <div class="info-box-title">Pipeline Enrichment Examples</div>
                        <pre><code>// GeoIP Enrichment
{
  "type": "geoip",
  "field": "src_ip",
  "target_field": "src_geo",
  "properties": ["country_name", "city_name", "location"]
}

// Threat Intel Lookup
{
  "type": "lookup",
  "field": "dest_ip",
  "lookup_file": "threat_intel.csv",
  "output_fields": ["threat_type", "confidence", "source"]
}

// Asset Context
{
  "type": "lookup",
  "field": "src_ip",
  "lookup_file": "asset_inventory.csv",
  "output_fields": ["asset_type", "criticality", "owner", "location"]
}</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Data Routing Strategies</h2>
                    
                    <div class="diagram">
                        <div class="diagram-title">Tiered Storage Architecture</div>
                        <pre><code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       DATA ROUTING BY VALUE                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  HIGH VALUE (Real-time SIEM)           MEDIUM VALUE (Data Lake)            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ â€¢ Security events           â”‚      â”‚ â€¢ Detailed access logs      â”‚      â”‚
â”‚  â”‚ â€¢ Authentication logs       â”‚      â”‚ â€¢ Web proxy verbose         â”‚      â”‚
â”‚  â”‚ â€¢ Endpoint detections       â”‚      â”‚ â€¢ Flow data (sampled)       â”‚      â”‚
â”‚  â”‚ â€¢ Cloud security alerts     â”‚      â”‚ â€¢ DNS queries               â”‚      â”‚
â”‚  â”‚ â€¢ Network threat logs       â”‚      â”‚ â€¢ Application logs          â”‚      â”‚
â”‚  â”‚                             â”‚      â”‚                             â”‚      â”‚
â”‚  â”‚ Retention: 90 days          â”‚      â”‚ Retention: 1 year           â”‚      â”‚
â”‚  â”‚ Cost: $$$                   â”‚      â”‚ Cost: $$                    â”‚      â”‚
â”‚  â”‚ Query: Real-time            â”‚      â”‚ Query: Minutes              â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                             â”‚
â”‚  LOW VALUE (Archive)                   DROP (Never Store)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ â€¢ Debug/trace logs          â”‚      â”‚ â€¢ Heartbeat/health checks   â”‚      â”‚
â”‚  â”‚ â€¢ Compliance retention      â”‚      â”‚ â€¢ Redundant events          â”‚      â”‚
â”‚  â”‚ â€¢ Raw network captures      â”‚      â”‚ â€¢ Internal monitoring noise â”‚      â”‚
â”‚  â”‚                             â”‚      â”‚ â€¢ Known benign patterns     â”‚      â”‚
â”‚  â”‚ Retention: 7 years          â”‚      â”‚                             â”‚      â”‚
â”‚  â”‚ Cost: $                     â”‚      â”‚ Cost: $0                    â”‚      â”‚
â”‚  â”‚ Query: Hours                â”‚      â”‚                             â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">Cribl: Routing Rules</div>
                        <pre><code>// Route high-value to SIEM, rest to lake
routes:
  - id: security_events
    filter: sourcetype IN ['WinEventLog:Security', 'sysmon', 'endpoint_alerts']
    output: splunk_hec
    
  - id: cloud_security
    filter: sourcetype IN ['aws:cloudtrail', 'azure:activitylog', 'gcp:audit']
    output: splunk_hec
    
  - id: verbose_logs
    filter: sourcetype IN ['proxy_access', 'dns_query', 'netflow']
    output: s3_data_lake
    
  - id: compliance_archive
    filter: _index == 'compliance'
    output: glacier_archive
    
  - id: drop_noise
    filter: sourcetype == 'heartbeat' OR message LIKE '%health check%'
    output: devnull</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Volume Reduction Techniques</h2>
                    
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Technique</th>
                                    <th>Reduction</th>
                                    <th>Risk</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Field Removal</strong></td>
                                    <td>10-30%</td>
                                    <td>Low - remove truly unnecessary fields</td>
                                </tr>
                                <tr>
                                    <td><strong>Event Filtering</strong></td>
                                    <td>20-50%</td>
                                    <td>Medium - may miss edge cases</td>
                                </tr>
                                <tr>
                                    <td><strong>Sampling</strong></td>
                                    <td>50-90%</td>
                                    <td>Medium - statistical validity required</td>
                                </tr>
                                <tr>
                                    <td><strong>Aggregation</strong></td>
                                    <td>80-95%</td>
                                    <td>Medium - lose individual events</td>
                                </tr>
                                <tr>
                                    <td><strong>Deduplication</strong></td>
                                    <td>10-40%</td>
                                    <td>Low - if done correctly</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">Aggregation Example</div>
                        <pre><code>// Before: 1000 events per minute
{
  "timestamp": "2024-03-15T10:00:01Z",
  "action": "allow",
  "src_ip": "10.1.1.100",
  "dest_ip": "8.8.8.8",
  "bytes": 1024
}
// ... x1000

// After aggregation: 1 event per minute
{
  "timestamp": "2024-03-15T10:00:00Z",
  "action": "allow",
  "src_ip": "10.1.1.100",
  "dest_ip": "8.8.8.8",
  "event_count": 1000,
  "bytes_total": 1024000,
  "bytes_avg": 1024
}

// 99.9% reduction while preserving metrics</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Pipeline Tools</h2>
                    
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Tool</th>
                                    <th>Strength</th>
                                    <th>Use Case</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Cribl Stream</strong></td>
                                    <td>Routing, transformation, reduction</td>
                                    <td>Enterprise data routing hub</td>
                                </tr>
                                <tr>
                                    <td><strong>Kafka</strong></td>
                                    <td>Scalable message queue</td>
                                    <td>High-volume buffering</td>
                                </tr>
                                <tr>
                                    <td><strong>Logstash</strong></td>
                                    <td>Parsing, enrichment</td>
                                    <td>Elastic ecosystem</td>
                                </tr>
                                <tr>
                                    <td><strong>Fluentd</strong></td>
                                    <td>Cloud-native, plugins</td>
                                    <td>Kubernetes environments</td>
                                </tr>
                                <tr>
                                    <td><strong>Vector</strong></td>
                                    <td>High performance</td>
                                    <td>Resource-constrained environments</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section class="content-section">
                    <div class="info-box interview">
                        <div class="info-box-title">ğŸ’¼ Interview Tip</div>
                        <p><strong>Q: "How would you design a log pipeline for cost optimization?"</strong></p>
                        <p><strong>A:</strong> "I design pipelines with a tiered approach:</p>
                        <ol>
                            <li><strong>Classify data by value:</strong> Not all logs are equal. Security events need real-time SIEM access. Verbose logs like proxy access can go to cheaper storage with slower query times.</li>
                            <li><strong>Process at the edge:</strong> Filter noise before it traverses the network. Drop heartbeats, deduplicate events, and aggregate high-volume sources at collection.</li>
                            <li><strong>Enrich early:</strong> Add GeoIP, threat intel, and asset context in the pipeline. This enables routing decisions and saves SIEM compute cycles.</li>
                            <li><strong>Route by use case:</strong> Real-time detection needs go to SIEM. Threat hunting data goes to a data lake. Compliance archives go to cold storage.</li>
                            <li><strong>Aggregate where safe:</strong> Connection logs can often be aggregated to 1-minute buckets without losing detection capability while reducing volume 90%+.</li>
                        </ol>
                        <p>Tools like Cribl make this practicalâ€”I can implement complex routing logic that sends the right data to the right destination at the right cost."</p>
                    </div>
                </section>

                <section class="content-section">
                    <div class="cheatsheet">
                        <div class="cheatsheet-title">ğŸ“‹ Pipeline Quick Reference</div>
                        <h4>Collection Methods</h4>
                        <ul>
                            <li>Agent: Endpoints, servers</li>
                            <li>Syslog: Network devices</li>
                            <li>API: SaaS, cloud</li>
                            <li>Webhook: Real-time events</li>
                        </ul>
                        <h4>Volume Reduction</h4>
                        <ul>
                            <li>Field removal: 10-30%</li>
                            <li>Filtering: 20-50%</li>
                            <li>Sampling: 50-90%</li>
                            <li>Aggregation: 80-95%</li>
                        </ul>
                        <h4>Routing Tiers</h4>
                        <ul>
                            <li>Hot (SIEM): Security events</li>
                            <li>Warm (Lake): Verbose logs</li>
                            <li>Cold (Archive): Compliance</li>
                            <li>Drop: Noise, duplicates</li>
                        </ul>
                    </div>
                </section>

                <div style="display: flex; justify-content: space-between; margin-top: var(--spacing-2xl); padding-top: var(--spacing-lg); border-top: 1px solid var(--border-default);">
                    <a href="siem-architecture.html" class="card-link">â† SIEM Architecture</a>
                    <a href="siem-data-flow.html" class="card-link">Data Flow â†’</a>
                </div>
            </div>
        </main>
    </div>
    <script src="main.js"></script>
</body>
</html>
