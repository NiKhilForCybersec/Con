<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Log Parsing | SIEM Consultant Portfolio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <button class="mobile-menu-toggle" aria-label="Toggle navigation"><span></span></button>
    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" style="text-decoration: none; color: inherit;">
                    <div class="sidebar-logo"><div class="sidebar-logo-icon">âš¡</div>SIEM Consultant</div>
                </a>
                <div class="sidebar-subtitle">Knowledge Portfolio</div>
            </div>
                        <nav class="sidebar-nav">
                <!-- Foundation -->
                <div class="nav-section">
                    <div class="nav-section-title">Foundation</div>
                    <a href="index.html" class="nav-item">Home</a>
                    <a href="approach.html" class="nav-item">Consulting Approach</a>
                    <a href="deliverables.html" class="nav-item">Project Deliverables</a>
                    <a href="experience.html" class="nav-item">Experience</a>
                </div>
                
                <!-- SIEM Fundamentals -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Fundamentals</div>
                    <a href="what-is-siem.html" class="nav-item">What is SIEM?</a>
                    <a href="siem-architecture.html" class="nav-item">SIEM Architecture</a>
                    <a href="siem-data-flow.html" class="nav-item">SIEM Data Flow</a>
                    <a href="platform-comparison.html" class="nav-item">Platform Comparison</a>
                    <a href="siem-metrics.html" class="nav-item">SIEM Metrics</a>
                    <a href="siem-health.html" class="nav-item">SIEM Health</a>
                    <a href="siem-rfp.html" class="nav-item">SIEM RFP Guide</a>
                    <a href="security-data-lake.html" class="nav-item">Security Data Lake</a>
                </div>
                
                <!-- SIEM Platforms -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Platforms</div>
                    <a href="splunk-overview.html" class="nav-item">Splunk Overview</a>
                    <a href="splunk-cloud.html" class="nav-item">Splunk Cloud</a>
                    <a href="splunk-hybrid.html" class="nav-item">Splunk Hybrid</a>
                    <a href="sentinel-overview.html" class="nav-item">Microsoft Sentinel</a>
                </div>
                
                <!-- Log Sources -->
                <div class="nav-section">
                    <div class="nav-section-title">Log Sources</div>
                    <a href="log-sources-overview.html" class="nav-item">Log Sources Overview</a>
                    <a href="windows-logs.html" class="nav-item">Windows Logs</a>
                    <a href="linux-logs.html" class="nav-item">Linux Logs</a>
                    <a href="network-logs.html" class="nav-item">Network Logs</a>
                    <a href="cloud-logs.html" class="nav-item">Cloud Logs</a>
                    <a href="endpoint-logs.html" class="nav-item">Endpoint Logs</a>
                    <a href="identity-logs.html" class="nav-item">Identity Logs</a>
                    <a href="application-logs.html" class="nav-item">Application Logs</a>
                </div>
                
                <!-- Log Engineering -->
                <div class="nav-section">
                    <div class="nav-section-title">Log Engineering</div>
                    <a href="log-pipeline.html" class="nav-item">Log Pipeline</a>
                    <a href="log-parsing.html" class="nav-item active">Log Parsing</a>
                    <a href="log-retention.html" class="nav-item">Log Retention</a>
                </div>
                
                <!-- SIEM Migrations -->
                <div class="nav-section">
                    <div class="nav-section-title">SIEM Migrations</div>
                    <a href="migration-methodology.html" class="nav-item">Migration Methodology</a>
                    <a href="discovery-assessment.html" class="nav-item">Discovery & Assessment</a>
                    <a href="log-migration.html" class="nav-item">Log Migration</a>
                    <a href="detection-migration.html" class="nav-item">Detection Migration</a>
                    <a href="query-translation.html" class="nav-item">Query Translation</a>
                </div>
                
                <!-- Detection Engineering -->
                <div class="nav-section">
                    <div class="nav-section-title">Detection Engineering</div>
                    <a href="detection-fundamentals.html" class="nav-item">Detection Fundamentals</a>
                    <a href="use-case-development.html" class="nav-item">Use Case Development</a>
                    <a href="tuning-methodology.html" class="nav-item">Tuning Methodology</a>
                    <a href="sigma-rules.html" class="nav-item">Sigma Rules</a>
                    <a href="alert-enrichment.html" class="nav-item">Alert Enrichment</a>
                    <a href="alert-fatigue.html" class="nav-item">Alert Fatigue</a>
                </div>
                
                <!-- Threat Detection -->
                <div class="nav-section">
                    <div class="nav-section-title">Threat Detection</div>
                    <a href="mitre-attack-intro.html" class="nav-item">MITRE ATT&CK</a>
                    <a href="threat-modeling.html" class="nav-item">Threat Modeling</a>
                    <a href="threat-intelligence.html" class="nav-item">Threat Intelligence</a>
                    <a href="threat-hunting.html" class="nav-item">Threat Hunting</a>
                    <a href="ueba-analytics.html" class="nav-item">UEBA Analytics</a>
                </div>
                
                <!-- Query Languages -->
                <div class="nav-section">
                    <div class="nav-section-title">Query Languages</div>
                    <a href="spl-fundamentals.html" class="nav-item">SPL Fundamentals</a>
                    <a href="kql-fundamentals.html" class="nav-item">KQL Fundamentals</a>
                </div>
                
                <!-- Windows Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Windows Security</div>
                    <a href="sysmon-config.html" class="nav-item">Sysmon Configuration</a>
                    <a href="windows-attack-techniques.html" class="nav-item">Windows Attacks</a>
                    <a href="windows-hardening.html" class="nav-item">Windows Hardening</a>
                    <a href="powershell-security.html" class="nav-item">PowerShell Security</a>
                </div>
                
                <!-- Cloud Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Cloud Security</div>
                    <a href="cloud-security-monitoring.html" class="nav-item">Cloud Monitoring</a>
                    <a href="azure-security.html" class="nav-item">Azure Security</a>
                    <a href="aws-security.html" class="nav-item">AWS Security</a>
                    <a href="gcp-security.html" class="nav-item">GCP Security</a>
                    <a href="m365-security.html" class="nav-item">M365 Security</a>
                    <a href="container-security.html" class="nav-item">Container Security</a>
                </div>
                
                <!-- Network Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Network Security</div>
                    <a href="network-security-monitoring.html" class="nav-item">Network Monitoring</a>
                    <a href="dns-security.html" class="nav-item">DNS Security</a>
                    <a href="zero-trust.html" class="nav-item">Zero Trust</a>
                </div>
                
                <!-- Identity Security -->
                <div class="nav-section">
                    <div class="nav-section-title">Identity Security</div>
                    <a href="identity-security.html" class="nav-item">Identity Security</a>
                    <a href="active-directory.html" class="nav-item">Active Directory</a>
                </div>
                
                <!-- Data Protection -->
                <div class="nav-section">
                    <div class="nav-section-title">Data Protection</div>
                    <a href="dlp-monitoring.html" class="nav-item">DLP Monitoring</a>
                    <a href="data-classification.html" class="nav-item">Data Classification</a>
                    <a href="data-exfiltration.html" class="nav-item">Data Exfiltration</a>
                    <a href="insider-threats.html" class="nav-item">Insider Threats</a>
                </div>
                
                <!-- Specific Threats -->
                <div class="nav-section">
                    <div class="nav-section-title">Threat Scenarios</div>
                    <a href="phishing-detection.html" class="nav-item">Phishing Detection</a>
                    <a href="ransomware-detection.html" class="nav-item">Ransomware Detection</a>
                    <a href="email-security.html" class="nav-item">Email Security</a>
                </div>
                
                <!-- SOC Operations -->
                <div class="nav-section">
                    <div class="nav-section-title">SOC Operations</div>
                    <a href="soc-operations.html" class="nav-item">SOC Operations</a>
                    <a href="incident-response.html" class="nav-item">Incident Response</a>
                    <a href="incident-metrics.html" class="nav-item">Incident Metrics</a>
                    <a href="case-management.html" class="nav-item">Case Management</a>
                    <a href="dashboard-design.html" class="nav-item">Dashboard Design</a>
                    <a href="runbook-development.html" class="nav-item">Runbook Development</a>
                </div>
                
                <!-- Automation -->
                <div class="nav-section">
                    <div class="nav-section-title">Automation</div>
                    <a href="soar-automation.html" class="nav-item">SOAR Automation</a>
                    <a href="security-playbooks.html" class="nav-item">Security Playbooks</a>
                    <a href="python-security.html" class="nav-item">Python for Security</a>
                </div>
                
                <!-- Integrations -->
                <div class="nav-section">
                    <div class="nav-section-title">Integrations</div>
                    <a href="edr-integration.html" class="nav-item">EDR Integration</a>
                    <a href="vulnerability-management.html" class="nav-item">Vulnerability Mgmt</a>
                    <a href="api-security.html" class="nav-item">API Security</a>
                </div>
                
                <!-- Operations -->
                <div class="nav-section">
                    <div class="nav-section-title">Operations</div>
                    <a href="performance-optimization.html" class="nav-item">Performance</a>
                    <a href="cost-optimization.html" class="nav-item">Cost Optimization</a>
                    <a href="compliance-governance.html" class="nav-item">Compliance</a>
                </div>
                
                <!-- Interview Prep -->
                <div class="nav-section">
                    <div class="nav-section-title">Interview Prep</div>
                    <a href="interview-strategy.html" class="nav-item">â­ Interview Strategy</a>
                    <a href="common-questions.html" class="nav-item">Common Questions</a>
                    <a href="interview-scenarios.html" class="nav-item">Scenarios</a>
                </div>
            </nav>
        </aside>
        <main class="main-content">
            <div class="content-wrapper">
                <nav class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-current">Log Parsing</span>
                </nav>

                <header class="page-header">
                    <h1 class="page-title">Log Parsing & Field Extraction</h1>
                    <p class="page-subtitle">Raw logs are just text. Parsing transforms them into structured, searchable fields. Good parsing enables fast queries, accurate detections, and meaningful dashboards.</p>
                </header>

                <section class="content-section">
                    <h2>Parsing Concepts</h2>
                    
                    <div class="diagram">
                        <div class="diagram-title">Log Parsing Pipeline</div>
                        <pre><code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        LOG PARSING FLOW                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  RAW LOG                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Jan 15 14:32:05 webserver01 nginx: 192.168.1.100 - admin [15/Jan/   â”‚   â”‚
â”‚  â”‚ 2024:14:32:05 -0500] "GET /api/users HTTP/1.1" 200 1542 "-"         â”‚   â”‚
â”‚  â”‚ "Mozilla/5.0" rt=0.032                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  PARSING STEPS                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Timestamp   â”‚â†’ â”‚ Source      â”‚â†’ â”‚ Regex/Grok  â”‚â†’ â”‚ Field Type  â”‚       â”‚
â”‚  â”‚ Extraction  â”‚  â”‚ Identificationâ”‚ â”‚ Patterns   â”‚  â”‚ Conversion  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  STRUCTURED OUTPUT                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ {                                                                    â”‚   â”‚
â”‚  â”‚   "timestamp": "2024-01-15T14:32:05-05:00",                         â”‚   â”‚
â”‚  â”‚   "host": "webserver01",                                            â”‚   â”‚
â”‚  â”‚   "source": "nginx",                                                â”‚   â”‚
â”‚  â”‚   "src_ip": "192.168.1.100",                                        â”‚   â”‚
â”‚  â”‚   "user": "admin",                                                  â”‚   â”‚
â”‚  â”‚   "method": "GET",                                                  â”‚   â”‚
â”‚  â”‚   "uri": "/api/users",                                              â”‚   â”‚
â”‚  â”‚   "status_code": 200,                                               â”‚   â”‚
â”‚  â”‚   "bytes": 1542,                                                    â”‚   â”‚
â”‚  â”‚   "response_time": 0.032                                            â”‚   â”‚
â”‚  â”‚ }                                                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Splunk Field Extraction</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">props.conf: Sourcetype Configuration</div>
                        <pre><code>[nginx:access]
TIME_FORMAT = %d/%b/%Y:%H:%M:%S %z
TIME_PREFIX = \[
MAX_TIMESTAMP_LOOKAHEAD = 30
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TRUNCATE = 10000
CHARSET = UTF-8

# Inline field extractions
EXTRACT-nginx_fields = ^(?P<src_ip>\d+\.\d+\.\d+\.\d+)\s+-\s+(?P<user>\S+)\s+\[(?P<timestamp>[^\]]+)\]\s+"(?P<method>\w+)\s+(?P<uri>\S+)\s+(?P<http_version>[^"]+)"\s+(?P<status_code>\d+)\s+(?P<bytes>\d+)</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">SPL: Search-Time Extraction</div>
                        <pre><code>index=web sourcetype=nginx:access
| rex field=_raw "^(?P<src_ip>\d+\.\d+\.\d+\.\d+)"
| rex field=_raw "\"(?P<method>\w+)\s+(?P<uri>[^\s]+)"
| rex field=_raw "\"\s+(?P<status>\d{3})\s+(?P<bytes>\d+)"
| rex field=_raw "rt=(?P<response_time>[\d.]+)"
| eval response_time_ms = round(response_time * 1000, 2)
| table _time, src_ip, method, uri, status, bytes, response_time_ms</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">transforms.conf: Lookup-Based Extraction</div>
                        <pre><code># transforms.conf
[nginx_status_lookup]
filename = http_status_codes.csv
match_type = WILDCARD(status_code)
default_match = Unknown

# props.conf
[nginx:access]
LOOKUP-status = nginx_status_lookup status_code OUTPUT status_description</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Microsoft Sentinel Parsing</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Parse JSON Logs</div>
                        <pre><code>// Parse JSON from raw log
CommonSecurityLog
| where DeviceVendor == "CustomApp"
| extend ParsedMessage = parse_json(Message)
| extend 
    UserName = tostring(ParsedMessage.user),
    Action = tostring(ParsedMessage.action),
    ResourceId = tostring(ParsedMessage.resource_id),
    Result = tostring(ParsedMessage.result)
| project TimeGenerated, UserName, Action, ResourceId, Result</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Regex Field Extraction</div>
                        <pre><code>// Extract fields from unstructured log
Syslog
| where Facility == "local0"
| extend UserName = extract(@"user=([^\s,]+)", 1, SyslogMessage)
| extend SourceIP = extract(@"src=(\d+\.\d+\.\d+\.\d+)", 1, SyslogMessage)
| extend Action = extract(@"action=(\w+)", 1, SyslogMessage)
| extend Status = extract(@"status=(\w+)", 1, SyslogMessage)
| where isnotempty(UserName)
| project TimeGenerated, UserName, SourceIP, Action, Status</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Parse Key-Value Pairs</div>
                        <pre><code>// Parse key=value format
Syslog
| where SyslogMessage has "key="
| extend KVPairs = parse_kv(SyslogMessage, "=", " ")
| extend 
    User = tostring(KVPairs.user),
    Source = tostring(KVPairs.src),
    Destination = tostring(KVPairs.dst),
    Port = toint(KVPairs.dpt)
| project TimeGenerated, User, Source, Destination, Port</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Common Parsing Patterns</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">Syslog Parsing</div>
                        <pre><code>// Standard syslog format
// &lt;priority&gt;timestamp hostname process[pid]: message

Regex Pattern:
^<(?P<priority>\d+)>(?P<timestamp>\w+\s+\d+\s+[\d:]+)\s+(?P<hostname>\S+)\s+(?P<process>\S+?)(?:\[(?P<pid>\d+)\])?:\s+(?P<message>.*)$

// Example:
// <134>Jan 15 14:32:05 server01 sshd[12345]: Accepted password for user1 from 10.1.1.1</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">Windows Event Log XML</div>
                        <pre><code>// Windows Security Event parsing in Splunk
[source::WinEventLog:Security]
KV_MODE = xml
SHOULD_LINEMERGE = false

// Search example
index=windows sourcetype=WinEventLog:Security EventCode=4624
| eval src_ip = mvindex(Logon_Information.Workstation_Name, 0)
| eval user = mvindex(New_Logon.Account_Name, 0)
| eval logon_type = mvindex(Logon_Information.Logon_Type, 0)</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">CEF (Common Event Format)</div>
                        <pre><code>// CEF format parsing
// CEF:Version|Device Vendor|Device Product|Device Version|Signature ID|Name|Severity|Extension

Regex:
^CEF:(?P<version>\d+)\|(?P<vendor>[^|]*)\|(?P<product>[^|]*)\|(?P<device_version>[^|]*)\|(?P<sig_id>[^|]*)\|(?P<name>[^|]*)\|(?P<severity>[^|]*)\|(?P<extension>.*)$

// Extension fields are key=value pairs
// Example: src=10.0.0.1 dst=192.168.1.1 act=blocked</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Field Normalization</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">SPL: Field Aliasing</div>
                        <pre><code># props.conf - Normalize field names across sources
[firewall:paloalto]
FIELDALIAS-src = src_ip AS src
FIELDALIAS-dst = dst_ip AS dest
FIELDALIAS-user = user_name AS user

[firewall:cisco]
FIELDALIAS-src = source_address AS src
FIELDALIAS-dst = destination_address AS dest
FIELDALIAS-user = username AS user

# Now queries work across both:
index=firewall src=10.1.1.* | stats count by dest</code></pre>
                    </div>

                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Union with Normalization</div>
                        <pre><code>// Normalize across different log sources
let PaloAlto = CommonSecurityLog
| where DeviceVendor == "Palo Alto Networks"
| extend 
    SourceIP = SourceIP,
    DestIP = DestinationIP,
    User = SourceUserName,
    Action = DeviceAction;
let Cisco = CommonSecurityLog
| where DeviceVendor == "Cisco"
| extend 
    SourceIP = SourceIP,
    DestIP = DestinationIP,
    User = coalesce(SourceUserName, "Unknown"),
    Action = DeviceAction;
union PaloAlto, Cisco
| project TimeGenerated, DeviceVendor, SourceIP, DestIP, User, Action</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Parsing Best Practices</h2>
                    
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Practice</th>
                                    <th>Rationale</th>
                                    <th>Example</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Parse at index time</strong></td>
                                    <td>Faster searches, smaller index</td>
                                    <td>Use EXTRACT in props.conf</td>
                                </tr>
                                <tr>
                                    <td><strong>Normalize field names</strong></td>
                                    <td>Enable cross-source correlation</td>
                                    <td>src_ip, dest_ip, user (not source_addr)</td>
                                </tr>
                                <tr>
                                    <td><strong>Type fields correctly</strong></td>
                                    <td>Enable proper sorting/comparison</td>
                                    <td>status_code as int, not string</td>
                                </tr>
                                <tr>
                                    <td><strong>Handle multi-value</strong></td>
                                    <td>Some fields have multiple values</td>
                                    <td>mvindex(), mv-expand in KQL</td>
                                </tr>
                                <tr>
                                    <td><strong>Test edge cases</strong></td>
                                    <td>Logs vary; patterns must handle variation</td>
                                    <td>Missing fields, special characters</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section class="content-section">
                    <div class="info-box interview">
                        <div class="info-box-title">ğŸ’¼ Interview Tip</div>
                        <p><strong>Q: "How do you approach parsing a new log source?"</strong></p>
                        <p><strong>A:</strong> "I follow a systematic process:</p>
                        <ol>
                            <li><strong>Sample collection:</strong> Get representative samples including edge casesâ€”errors, missing fields, different event types. One example isn't enough.</li>
                            <li><strong>Identify structure:</strong> Is it JSON, key-value, fixed position, or freeform? This determines the parsing approach.</li>
                            <li><strong>Map to use cases:</strong> What fields do detections need? I don't parse everythingâ€”only fields that support security use cases.</li>
                            <li><strong>Build incrementally:</strong> Start with core fields, validate, then add more. Complex regex that breaks is worse than simple regex that works.</li>
                            <li><strong>Normalize names:</strong> I follow a standard naming convention so this source correlates with others. src_ip not source_address.</li>
                            <li><strong>Test thoroughly:</strong> Run against historical data, check for extraction failures, validate field types.</li>
                        </ol>
                        <p>Good parsing is invisibleâ€”analysts don't think about it because fields just work. Bad parsing causes constant frustration."</p>
                    </div>
                </section>

                <section class="content-section">
                    <div class="cheatsheet">
                        <div class="cheatsheet-title">ğŸ“‹ Log Parsing Quick Reference</div>
                        <h4>Common Regex Patterns</h4>
                        <ul>
                            <li>IPv4: <code>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}</code></li>
                            <li>IPv6: <code>[0-9a-fA-F:]+</code></li>
                            <li>Email: <code>[\w.-]+@[\w.-]+</code></li>
                            <li>Domain: <code>[\w.-]+\.[a-zA-Z]{2,}</code></li>
                            <li>MAC: <code>[0-9a-fA-F]{2}(:[0-9a-fA-F]{2}){5}</code></li>
                        </ul>
                        <h4>Splunk Extraction Types</h4>
                        <ul>
                            <li>EXTRACT - Regex at index time</li>
                            <li>REPORT - Reference transforms.conf</li>
                            <li>FIELDALIAS - Create field aliases</li>
                            <li>EVAL - Calculated fields</li>
                            <li>LOOKUP - Enrich from CSV</li>
                        </ul>
                        <h4>KQL Parse Functions</h4>
                        <ul>
                            <li>parse_json() - JSON parsing</li>
                            <li>parse_kv() - Key-value parsing</li>
                            <li>extract() - Regex extraction</li>
                            <li>split() - Delimiter splitting</li>
                        </ul>
                    </div>
                </section>

                <div style="display: flex; justify-content: space-between; margin-top: var(--spacing-2xl); padding-top: var(--spacing-lg); border-top: 1px solid var(--border-default);">
                    <a href="log-sources-overview.html" class="card-link">â† Log Sources</a>
                    <a href="log-pipeline.html" class="card-link">Log Pipeline â†’</a>
                </div>
            </div>
        </main>
    </div>
    <script src="main.js"></script>
</body>
</html>
