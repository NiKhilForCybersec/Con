<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Threat Modeling | SIEM Consultant Portfolio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <button class="mobile-menu-toggle" aria-label="Toggle navigation"><span></span></button>
    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" style="text-decoration: none; color: inherit;">
                    <div class="sidebar-logo"><div class="sidebar-logo-icon">âš¡</div>SIEM Consultant</div>
                </a>
                <div class="sidebar-subtitle">Knowledge Portfolio</div>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Foundation</div>
                    <a href="index.html" class="nav-item">Home</a>
                    <a href="approach.html" class="nav-item">Consulting Approach</a>
                    <a href="experience.html" class="nav-item">Experience</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection Strategy</div>
                    <a href="mitre-attack-intro.html" class="nav-item">MITRE ATT&CK</a>
                    <a href="threat-modeling.html" class="nav-item active">Threat Modeling</a>
                </div>
            </nav>
        </aside>
        <main class="main-content">
            <div class="content-wrapper">
                <nav class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-current">Threat Modeling</span>
                </nav>

                <header class="page-header">
                    <h1 class="page-title">Threat Modeling for Detection</h1>
                    <p class="page-subtitle">Threat modeling identifies what threats matter to your organization and guides detection engineering priorities. Understanding your adversaries enables focused, effective security monitoring.</p>
                </header>

                <section class="content-section">
                    <h2>Threat Modeling Process</h2>
                    
                    <div class="diagram">
                        <div class="diagram-title">Detection-Focused Threat Model</div>
                        <pre><code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    THREAT MODELING FOR SIEM                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  STEP 1: IDENTIFY CROWN JEWELS                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ What are we protecting?                                              â”‚   â”‚
â”‚  â”‚ â€¢ Customer PII database                                              â”‚   â”‚
â”‚  â”‚ â€¢ Source code repositories                                           â”‚   â”‚
â”‚  â”‚ â€¢ Financial systems                                                  â”‚   â”‚
â”‚  â”‚ â€¢ Intellectual property                                              â”‚   â”‚
â”‚  â”‚ â€¢ Executive communications                                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  STEP 2: IDENTIFY THREAT ACTORS                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Who would target us?                                                 â”‚   â”‚
â”‚  â”‚ â€¢ Nation-state (industry espionage)                                  â”‚   â”‚
â”‚  â”‚ â€¢ Cybercrime (ransomware, BEC)                                       â”‚   â”‚
â”‚  â”‚ â€¢ Insider (data theft, sabotage)                                     â”‚   â”‚
â”‚  â”‚ â€¢ Hacktivist (reputation damage)                                     â”‚   â”‚
â”‚  â”‚ â€¢ Opportunistic (exposed vulnerabilities)                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  STEP 3: MAP ATTACK PATHS                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ How would they reach crown jewels?                                   â”‚   â”‚
â”‚  â”‚ â€¢ Phishing â†’ Workstation â†’ AD â†’ Database Server                     â”‚   â”‚
â”‚  â”‚ â€¢ Exposed RDP â†’ Lateral Movement â†’ File Server                      â”‚   â”‚
â”‚  â”‚ â€¢ Supply Chain â†’ Trusted App â†’ Internal Network                     â”‚   â”‚
â”‚  â”‚ â€¢ Insider â†’ Direct Access â†’ Exfiltration                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  STEP 4: DERIVE DETECTION REQUIREMENTS                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ What must we detect?                                                 â”‚   â”‚
â”‚  â”‚ â€¢ Initial access attempts (phishing, exploitation)                   â”‚   â”‚
â”‚  â”‚ â€¢ Lateral movement (PsExec, RDP, admin shares)                      â”‚   â”‚
â”‚  â”‚ â€¢ Credential access (LSASS, Kerberoasting)                          â”‚   â”‚
â”‚  â”‚ â€¢ Data staging and exfiltration                                      â”‚   â”‚
â”‚  â”‚ â€¢ Insider anomalies (after-hours, unusual access)                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Threat Actor Profiles</h2>
                    
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Actor Type</th>
                                    <th>Motivation</th>
                                    <th>Typical TTPs</th>
                                    <th>Detection Focus</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Nation-State</strong></td>
                                    <td>Espionage, IP theft</td>
                                    <td>Spearphishing, 0-days, supply chain, living-off-the-land</td>
                                    <td>Persistence, slow exfil, unusual C2</td>
                                </tr>
                                <tr>
                                    <td><strong>Ransomware</strong></td>
                                    <td>Financial extortion</td>
                                    <td>RDP brute force, Cobalt Strike, AD compromise</td>
                                    <td>Lateral movement, shadow copy deletion</td>
                                </tr>
                                <tr>
                                    <td><strong>BEC/Fraud</strong></td>
                                    <td>Financial theft</td>
                                    <td>Phishing, inbox rules, impersonation</td>
                                    <td>Mail forwarding, payment redirects</td>
                                </tr>
                                <tr>
                                    <td><strong>Insider</strong></td>
                                    <td>Theft, sabotage, fraud</td>
                                    <td>Legitimate access abuse, data hoarding</td>
                                    <td>Behavioral anomalies, bulk access</td>
                                </tr>
                                <tr>
                                    <td><strong>Opportunistic</strong></td>
                                    <td>Easy targets</td>
                                    <td>Exploit public vulns, credential stuffing</td>
                                    <td>Scanning, brute force, exploit attempts</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Attack Path Analysis</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">Example: Ransomware Attack Path</div>
                        <pre><code>
ATTACK PATH: Ransomware via Phishing

Step 1: Initial Access
â”œâ”€â”€ Technique: Spearphishing attachment (T1566.001)
â”œâ”€â”€ Target: Employee workstation
â”œâ”€â”€ Detection: Email gateway alerts, suspicious attachment execution
â””â”€â”€ Log Sources: Email logs, EDR

Step 2: Execution
â”œâ”€â”€ Technique: Malicious macro, PowerShell (T1059.001)
â”œâ”€â”€ Target: Employee workstation
â”œâ”€â”€ Detection: Encoded PowerShell, macro execution
â””â”€â”€ Log Sources: EDR, Windows event logs

Step 3: Persistence
â”œâ”€â”€ Technique: Scheduled task (T1053.005)
â”œâ”€â”€ Target: Compromised workstation
â”œâ”€â”€ Detection: New scheduled task creation
â””â”€â”€ Log Sources: Windows event 4698

Step 4: Discovery
â”œâ”€â”€ Technique: AD enumeration (T1087)
â”œâ”€â”€ Target: Active Directory
â”œâ”€â”€ Detection: BloodHound, heavy LDAP queries
â””â”€â”€ Log Sources: DC logs, EDR

Step 5: Credential Access
â”œâ”€â”€ Technique: LSASS dump (T1003.001)
â”œâ”€â”€ Target: Memory
â”œâ”€â”€ Detection: LSASS access from unusual process
â””â”€â”€ Log Sources: EDR, Sysmon event 10

Step 6: Lateral Movement
â”œâ”€â”€ Technique: PsExec, RDP (T1021)
â”œâ”€â”€ Target: Servers, domain controllers
â”œâ”€â”€ Detection: New services, admin share access
â””â”€â”€ Log Sources: Windows event 7045, 5140

Step 7: Impact
â”œâ”€â”€ Technique: Data encryption (T1486)
â”œâ”€â”€ Target: File servers, databases
â”œâ”€â”€ Detection: Shadow copy deletion, mass file changes
â””â”€â”€ Log Sources: Windows event 4663, EDR
                        </code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>STRIDE for Detection</h2>
                    
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>STRIDE Category</th>
                                    <th>Threat</th>
                                    <th>Detection Approach</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Spoofing</strong></td>
                                    <td>Identity impersonation</td>
                                    <td>Impossible travel, anomalous sign-ins</td>
                                </tr>
                                <tr>
                                    <td><strong>Tampering</strong></td>
                                    <td>Data/config modification</td>
                                    <td>File integrity monitoring, config changes</td>
                                </tr>
                                <tr>
                                    <td><strong>Repudiation</strong></td>
                                    <td>Denying actions</td>
                                    <td>Comprehensive audit logging</td>
                                </tr>
                                <tr>
                                    <td><strong>Information Disclosure</strong></td>
                                    <td>Data exposure</td>
                                    <td>DLP alerts, unusual data access</td>
                                </tr>
                                <tr>
                                    <td><strong>Denial of Service</strong></td>
                                    <td>Availability impact</td>
                                    <td>Resource exhaustion, service failures</td>
                                </tr>
                                <tr>
                                    <td><strong>Elevation of Privilege</strong></td>
                                    <td>Unauthorized access</td>
                                    <td>Privilege escalation, role changes</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Detection Gap Analysis</h2>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">KQL: Detection Coverage Assessment</div>
                        <pre><code>// Map existing detections to threat model
let ThreatModel = datatable(AttackPath:string, Technique:string, Priority:string)
[
    "Ransomware", "T1566.001", "Critical",
    "Ransomware", "T1059.001", "Critical",
    "Ransomware", "T1003.001", "Critical",
    "Ransomware", "T1021.002", "High",
    "Ransomware", "T1486", "Critical",
    "BEC", "T1566.001", "Critical",
    "BEC", "T1564.008", "High",  // Inbox rules
    "Insider", "T1048", "Critical"  // Exfiltration
];
let ExistingDetections = SecurityAlert
| where TimeGenerated > ago(90d)
| distinct AlertName, Tactics, Techniques
| mv-expand Technique = Techniques
| project AlertName, Technique = tostring(Technique);
ThreatModel
| join kind=leftouter ExistingDetections on Technique
| summarize 
    DetectionCount = countif(isnotnull(AlertName)),
    Detections = make_set(AlertName)
  by AttackPath, Technique, Priority
| extend CoverageStatus = iff(DetectionCount > 0, "âœ… Covered", "âŒ Gap")
| order by Priority, AttackPath</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <div class="info-box interview">
                        <div class="info-box-title">ğŸ’¼ Interview Tip</div>
                        <p><strong>Q: "How do you prioritize detection engineering efforts?"</strong></p>
                        <p><strong>A:</strong> "I use threat modeling to focus detection efforts:</p>
                        <ol>
                            <li><strong>Identify crown jewels:</strong> What data/systems would hurt most if compromised? Detection priorities flow from business risk.</li>
                            <li><strong>Profile threat actors:</strong> Who realistically targets our industry? A healthcare org focuses on ransomware and insider threats. A defense contractor focuses on nation-state.</li>
                            <li><strong>Map attack paths:</strong> How would adversaries reach crown jewels? This creates a prioritized list of techniques to detect.</li>
                            <li><strong>Assess current coverage:</strong> I map existing detections against the threat model. Gaps in high-priority paths get immediate attention.</li>
                            <li><strong>Leverage threat intel:</strong> What are threat actors actually doing right now? Recent campaigns inform near-term priorities.</li>
                            <li><strong>Continuous refinement:</strong> Threat models aren't static. New threats, new assets, new adversary TTPs require updates.</li>
                        </ol>
                        <p>Without threat modeling, you're building detections randomly. With it, every detection maps to real risk."</p>
                    </div>
                </section>

                <section class="content-section">
                    <div class="cheatsheet">
                        <div class="cheatsheet-title">ğŸ“‹ Threat Modeling Quick Reference</div>
                        <h4>Key Questions</h4>
                        <ul>
                            <li>What are we protecting?</li>
                            <li>Who would attack us?</li>
                            <li>How would they attack?</li>
                            <li>What must we detect?</li>
                            <li>What gaps exist?</li>
                        </ul>
                        <h4>Common Frameworks</h4>
                        <ul>
                            <li>STRIDE (threat categories)</li>
                            <li>MITRE ATT&CK (techniques)</li>
                            <li>Kill Chain (attack phases)</li>
                            <li>PASTA (risk-centric)</li>
                        </ul>
                        <h4>Prioritization Factors</h4>
                        <ul>
                            <li>Asset criticality</li>
                            <li>Threat likelihood</li>
                            <li>Detection feasibility</li>
                            <li>Current coverage gaps</li>
                        </ul>
                    </div>
                </section>

                <div style="display: flex; justify-content: space-between; margin-top: var(--spacing-2xl); padding-top: var(--spacing-lg); border-top: 1px solid var(--border-default);">
                    <a href="mitre-attack-intro.html" class="card-link">â† MITRE ATT&CK</a>
                    <a href="detection-engineering.html" class="card-link">Detection Engineering â†’</a>
                </div>
            </div>
        </main>
    </div>
    <script src="main.js"></script>
</body>
</html>
