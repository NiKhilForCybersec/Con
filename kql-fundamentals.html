<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KQL Fundamentals | SIEM Consultant Portfolio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <button class="mobile-menu-toggle" aria-label="Toggle navigation"><span></span></button>
    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" style="text-decoration: none; color: inherit;">
                    <div class="sidebar-logo"><div class="sidebar-logo-icon">‚ö°</div>SIEM Consultant</div>
                </a>
                <div class="sidebar-subtitle">Knowledge Portfolio</div>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Foundation</div>
                    <a href="index.html" class="nav-item">Home</a>
                    <a href="approach.html" class="nav-item">Consulting Approach</a>
                    <a href="experience.html" class="nav-item">Experience</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Query Languages</div>
                    <a href="spl-fundamentals.html" class="nav-item">SPL Fundamentals</a>
                    <a href="kql-fundamentals.html" class="nav-item active">KQL Fundamentals</a>
                    <a href="query-translation.html" class="nav-item">Query Translation</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Detection Engineering</div>
                    <a href="detection-fundamentals.html" class="nav-item">Fundamentals</a>
                    <a href="use-case-development.html" class="nav-item">Use Case Development</a>
                </div>
            </nav>
        </aside>
        <main class="main-content">
            <div class="content-wrapper">
                <nav class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-current">KQL Fundamentals</span>
                </nav>

                <header class="page-header">
                    <h1 class="page-title">KQL Fundamentals</h1>
                    <p class="page-subtitle">Kusto Query Language (KQL) powers Microsoft Sentinel, Azure Data Explorer, and Microsoft 365 Defender. This SQL-like language is essential for security analysis in Microsoft environments.</p>
                </header>

                <section class="content-section">
                    <h2>KQL Philosophy</h2>
                    <p>KQL uses a tabular expression model similar to SQL, with data flowing through operators:</p>
                    
                    <div class="diagram">
                        <div class="diagram-title">KQL Query Structure</div>
                        <pre><code>
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                                                                             ‚îÇ
‚îÇ   SecurityEvent                        // Start with table name            ‚îÇ
‚îÇ   | where EventID == 4625              // Filter rows                      ‚îÇ
‚îÇ   | where TimeGenerated > ago(24h)     // Time filter                      ‚îÇ
‚îÇ   | summarize Count = count() by SourceIP = IpAddress  // Aggregate        ‚îÇ
‚îÇ   | where Count > 5                    // Filter aggregated results        ‚îÇ
‚îÇ   | order by Count desc                // Sort                             ‚îÇ
‚îÇ   | take 10                            // Limit results                    ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îÇ   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê   ‚îÇ
‚îÇ   Each pipe (|) transforms the result set                                  ‚îÇ
‚îÇ   Data flows top to bottom through operators                               ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        </code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Tables in Sentinel</h2>
                    <p>Key security tables to know:</p>
                    
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Table</th>
                                    <th>Data Source</th>
                                    <th>Use Case</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>SecurityEvent</code></td>
                                    <td>Windows Security Log</td>
                                    <td>Auth, process, AD events</td>
                                </tr>
                                <tr>
                                    <td><code>SigninLogs</code></td>
                                    <td>Azure AD/Entra ID</td>
                                    <td>Cloud authentication</td>
                                </tr>
                                <tr>
                                    <td><code>AuditLogs</code></td>
                                    <td>Azure AD/Entra ID</td>
                                    <td>Directory changes</td>
                                </tr>
                                <tr>
                                    <td><code>CommonSecurityLog</code></td>
                                    <td>CEF/Syslog devices</td>
                                    <td>Firewalls, network devices</td>
                                </tr>
                                <tr>
                                    <td><code>Syslog</code></td>
                                    <td>Linux syslog</td>
                                    <td>Linux server logs</td>
                                </tr>
                                <tr>
                                    <td><code>DeviceEvents</code></td>
                                    <td>Defender for Endpoint</td>
                                    <td>Endpoint telemetry</td>
                                </tr>
                                <tr>
                                    <td><code>DeviceProcessEvents</code></td>
                                    <td>Defender for Endpoint</td>
                                    <td>Process execution</td>
                                </tr>
                                <tr>
                                    <td><code>OfficeActivity</code></td>
                                    <td>Microsoft 365</td>
                                    <td>O365 user activity</td>
                                </tr>
                                <tr>
                                    <td><code>AzureActivity</code></td>
                                    <td>Azure subscription</td>
                                    <td>Azure management operations</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Essential Operators</h2>
                    
                    <h3>where - Filtering</h3>
                    <pre><code>| where EventID == 4625                  // Equals
| where EventID != 4624                  // Not equals
| where EventID in (4624, 4625, 4648)    // Multiple values
| where EventID !in (4634, 4647)         // Not in list
| where Count > 10                       // Greater than
| where TimeGenerated > ago(24h)         // Time comparison
| where isnotempty(Account)              // Field has value
| where Account has "admin"              // Contains (case-insensitive)
| where Account hasprefix "svc_"         // Starts with
| where Account hassuffix "$"            // Ends with
| where Account matches regex @"\d+"     // Regex match</code></pre>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">üí° String Operators</div>
                        <table>
                            <tr><th>Operator</th><th>Description</th><th>Case Sensitive</th></tr>
                            <tr><td><code>==</code></td><td>Equals</td><td>Yes</td></tr>
                            <tr><td><code>=~</code></td><td>Equals</td><td>No</td></tr>
                            <tr><td><code>has</code></td><td>Contains word</td><td>No</td></tr>
                            <tr><td><code>has_cs</code></td><td>Contains word</td><td>Yes</td></tr>
                            <tr><td><code>contains</code></td><td>Contains substring</td><td>No</td></tr>
                            <tr><td><code>contains_cs</code></td><td>Contains substring</td><td>Yes</td></tr>
                            <tr><td><code>startswith</code></td><td>Starts with</td><td>No</td></tr>
                            <tr><td><code>endswith</code></td><td>Ends with</td><td>No</td></tr>
                        </table>
                    </div>

                    <h3>summarize - Aggregation</h3>
                    <pre><code>| summarize count()                      // Total count
| summarize Count = count()              // Named count
| summarize count() by Account           // Group by
| summarize count() by Account, Computer // Multiple groups
| summarize 
    Count = count(),
    UniqueHosts = dcount(Computer),
    Hosts = make_set(Computer)
  by Account                             // Multiple aggregations
| summarize sum(BytesSent)               // Sum
| summarize avg(Duration)                // Average
| summarize min(TimeGenerated), max(TimeGenerated)  // Time range
| summarize arg_max(TimeGenerated, *)    // Row with max time</code></pre>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">üí° Aggregation Functions</div>
                        <table>
                            <tr><th>Function</th><th>Description</th></tr>
                            <tr><td><code>count()</code></td><td>Number of rows</td></tr>
                            <tr><td><code>dcount(field)</code></td><td>Distinct count</td></tr>
                            <tr><td><code>countif(condition)</code></td><td>Conditional count</td></tr>
                            <tr><td><code>sum(field)</code></td><td>Sum of values</td></tr>
                            <tr><td><code>avg(field)</code></td><td>Average</td></tr>
                            <tr><td><code>min(field)</code></td><td>Minimum</td></tr>
                            <tr><td><code>max(field)</code></td><td>Maximum</td></tr>
                            <tr><td><code>make_set(field)</code></td><td>Unique values as array</td></tr>
                            <tr><td><code>make_list(field)</code></td><td>All values as array</td></tr>
                            <tr><td><code>arg_max(field, *)</code></td><td>Row with max value</td></tr>
                            <tr><td><code>arg_min(field, *)</code></td><td>Row with min value</td></tr>
                        </table>
                    </div>

                    <h3>extend - Create Fields</h3>
                    <pre><code>| extend Severity = "High"               // Static value
| extend DurationMin = Duration / 60     // Calculation
| extend FullName = strcat(First, " ", Last)  // Concatenation
| extend Domain = tolower(Domain)        // Transform
| extend Status = iif(Code == 200, "OK", "Error")  // Conditional
| extend Level = case(
    Score > 90, "Critical",
    Score > 70, "High", 
    Score > 50, "Medium",
    "Low")                                // Multiple conditions
| extend Day = dayofweek(TimeGenerated)  // Extract day
| extend Hour = hourofday(TimeGenerated) // Extract hour</code></pre>

                    <h3>project - Select/Rename Fields</h3>
                    <pre><code>| project TimeGenerated, Account, Computer  // Select fields
| project-away TenantId, SourceSystem       // Remove fields
| project-rename User = Account             // Rename
| project-reorder TimeGenerated, Account    // Reorder (first columns)</code></pre>

                    <h3>order by - Sorting</h3>
                    <pre><code>| order by Count desc                    // Descending
| order by TimeGenerated asc             // Ascending
| order by Severity desc, Count desc     // Multiple fields</code></pre>

                    <h3>take / limit - Limit Results</h3>
                    <pre><code>| take 10                                // First 10 rows
| limit 100                              // Same as take
| top 10 by Count                        // Top N by field</code></pre>

                    <h3>distinct - Unique Values</h3>
                    <pre><code>| distinct Account                       // Unique accounts
| distinct Account, Computer             // Unique combinations</code></pre>
                </section>

                <section class="content-section">
                    <h2>Time Operations</h2>
                    
                    <h3>Time Filtering</h3>
                    <pre><code>| where TimeGenerated > ago(24h)         // Last 24 hours
| where TimeGenerated > ago(7d)          // Last 7 days
| where TimeGenerated between (ago(7d) .. ago(1d))  // Range
| where TimeGenerated > datetime(2024-01-01)  // Specific date
| where TimeGenerated > startofday(ago(7d))   // Start of day</code></pre>

                    <h3>Time Binning</h3>
                    <pre><code>| summarize count() by bin(TimeGenerated, 1h)   // Per hour
| summarize count() by bin(TimeGenerated, 1d)   // Per day
| summarize count() by bin(TimeGenerated, 5m)   // Per 5 minutes</code></pre>

                    <h3>Time Functions</h3>
                    <pre><code>| extend Hour = hourofday(TimeGenerated)
| extend DayOfWeek = dayofweek(TimeGenerated)
| extend Date = format_datetime(TimeGenerated, "yyyy-MM-dd")
| extend Age = datetime_diff('hour', now(), TimeGenerated)
| extend StartOfHour = bin(TimeGenerated, 1h)</code></pre>
                </section>

                <section class="content-section">
                    <h2>Advanced Techniques</h2>
                    
                    <h3>let - Variables</h3>
                    <pre><code>// Define variables for reuse
let TimeWindow = 24h;
let Threshold = 10;
let ExcludedUsers = dynamic(["svc_backup", "svc_monitor"]);

SecurityEvent
| where TimeGenerated > ago(TimeWindow)
| where Account !in (ExcludedUsers)
| summarize Count = count() by Account
| where Count > Threshold</code></pre>

                    <h3>let with Subqueries</h3>
                    <pre><code>// Define a subquery result
let HighRiskIPs = 
    SigninLogs
    | where ResultType != 0
    | summarize FailCount = count() by IPAddress
    | where FailCount > 50
    | project IPAddress;

SigninLogs
| where IPAddress in (HighRiskIPs)
| where ResultType == 0  // Successful login from high-risk IP</code></pre>

                    <h3>join - Combine Tables</h3>
                    <pre><code>// Inner join
SecurityEvent
| where EventID == 4625
| join kind=inner (
    _GetWatchlist('VIP_Users') | project Account = SearchKey
) on Account

// Left outer join (keep all from left)
SigninLogs
| join kind=leftouter (
    IdentityInfo | project UserPrincipalName, Department
) on $left.UserPrincipalName == $right.UserPrincipalName</code></pre>
                    
                    <div class="info-box tip">
                        <div class="info-box-title">üí° Join Types</div>
                        <table>
                            <tr><th>Type</th><th>Description</th></tr>
                            <tr><td><code>inner</code></td><td>Matching rows only</td></tr>
                            <tr><td><code>leftouter</code></td><td>All left + matching right</td></tr>
                            <tr><td><code>rightouter</code></td><td>Matching left + all right</td></tr>
                            <tr><td><code>fullouter</code></td><td>All rows from both</td></tr>
                            <tr><td><code>leftanti</code></td><td>Left rows with no match</td></tr>
                            <tr><td><code>rightanti</code></td><td>Right rows with no match</td></tr>
                        </table>
                    </div>

                    <h3>union - Combine Tables</h3>
                    <pre><code>// Combine multiple tables
union SecurityEvent, Syslog
| where TimeGenerated > ago(1h)

// Union with specific columns
union 
    (SecurityEvent | project TimeGenerated, Source = Computer, Event = Activity),
    (Syslog | project TimeGenerated, Source = Computer, Event = SyslogMessage)</code></pre>

                    <h3>parse / extract - Field Extraction</h3>
                    <pre><code>// Parse structured text
| parse Message with * "User=" User " logged in from " IP
| parse kind=regex Message with * @"error code: (?<ErrorCode>\d+)"

// Extract with regex
| extend User = extract(@"User=(\w+)", 1, Message)
| extend IP = extract(@"(\d+\.\d+\.\d+\.\d+)", 1, Message)</code></pre>

                    <h3>mv-expand - Expand Arrays</h3>
                    <pre><code>// Expand array to rows
| mv-expand TargetResources
| extend ResourceName = tostring(TargetResources.displayName)</code></pre>

                    <h3>Watchlists</h3>
                    <pre><code>// Use watchlist for enrichment
let VIPUsers = _GetWatchlist('VIP_Users') | project Account = SearchKey;

SigninLogs
| where UserPrincipalName in (VIPUsers)

// Check against threat intel watchlist
let ThreatIPs = _GetWatchlist('ThreatIntel_IPs') | project IP = SearchKey;

CommonSecurityLog
| where SourceIP in (ThreatIPs) or DestinationIP in (ThreatIPs)</code></pre>
                </section>

                <section class="content-section">
                    <h2>Security Detection Queries</h2>
                    
                    <h3>Brute Force Detection</h3>
                    <pre><code>SecurityEvent
| where TimeGenerated > ago(1h)
| where EventID == 4625
| summarize 
    FailureCount = count(),
    TargetedUsers = dcount(TargetUserName),
    Users = make_set(TargetUserName, 10)
  by SourceIP = IpAddress, bin(TimeGenerated, 10m)
| where FailureCount > 10
| extend Severity = case(
    FailureCount > 100, "Critical",
    FailureCount > 50, "High",
    "Medium")
| project TimeGenerated, SourceIP, FailureCount, TargetedUsers, Users, Severity</code></pre>

                    <h3>Impossible Travel</h3>
                    <pre><code>SigninLogs
| where TimeGenerated > ago(7d)
| where ResultType == 0
| project TimeGenerated, UserPrincipalName, IPAddress, Location
| order by UserPrincipalName, TimeGenerated asc
| extend PrevTime = prev(TimeGenerated), PrevLocation = prev(Location), PrevUser = prev(UserPrincipalName)
| where UserPrincipalName == PrevUser
| extend TimeDiffHours = datetime_diff('hour', TimeGenerated, PrevTime)
| where Location != PrevLocation and TimeDiffHours < 2
| project TimeGenerated, UserPrincipalName, Location, PrevLocation, TimeDiffHours</code></pre>

                    <h3>Suspicious PowerShell</h3>
                    <pre><code>SecurityEvent
| where TimeGenerated > ago(24h)
| where EventID == 4688
| where NewProcessName endswith "powershell.exe" or NewProcessName endswith "pwsh.exe"
| where CommandLine has_any ("-enc", "-encoded", "downloadstring", "iex", "invoke-expression", "bypass")
| extend RiskIndicators = dynamic([])
| extend RiskIndicators = iif(CommandLine has "-enc", array_concat(RiskIndicators, dynamic(["Encoded"])), RiskIndicators)
| extend RiskIndicators = iif(CommandLine has "downloadstring", array_concat(RiskIndicators, dynamic(["Download"])), RiskIndicators)
| extend RiskIndicators = iif(CommandLine has "bypass", array_concat(RiskIndicators, dynamic(["Bypass"])), RiskIndicators)
| project TimeGenerated, Computer, SubjectUserName, CommandLine, RiskIndicators</code></pre>

                    <h3>Admin Group Changes</h3>
                    <pre><code>SecurityEvent
| where TimeGenerated > ago(24h)
| where EventID in (4728, 4729, 4732, 4733, 4756, 4757)
| extend Action = case(
    EventID in (4728, 4732, 4756), "Added",
    EventID in (4729, 4733, 4757), "Removed",
    "Unknown")
| extend GroupScope = case(
    EventID in (4728, 4729), "Global",
    EventID in (4732, 4733), "Local",
    EventID in (4756, 4757), "Universal",
    "Unknown")
| where TargetUserName has "admin" or TargetUserName has "privileged"
| project TimeGenerated, Computer, SubjectUserName, MemberName, TargetUserName, Action, GroupScope</code></pre>

                    <h3>Azure AD Risky Sign-ins</h3>
                    <pre><code>SigninLogs
| where TimeGenerated > ago(24h)
| where RiskLevelDuringSignIn in ("high", "medium")
| summarize 
    SignInCount = count(),
    RiskEvents = make_set(RiskEventTypes),
    Locations = make_set(Location)
  by UserPrincipalName, IPAddress, RiskLevelDuringSignIn
| order by RiskLevelDuringSignIn desc, SignInCount desc</code></pre>
                </section>

                <section class="content-section">
                    <h2>Query Optimization</h2>
                    
                    <h3>Performance Best Practices</h3>
                    <ul>
                        <li><strong>Filter early:</strong> Put <code>where</code> clauses as early as possible</li>
                        <li><strong>Time filter first:</strong> Always filter on <code>TimeGenerated</code> first</li>
                        <li><strong>Use <code>has</code> over <code>contains</code>:</strong> <code>has</code> is faster for word matching</li>
                        <li><strong>Avoid <code>*</code> in project:</strong> Select only needed columns</li>
                        <li><strong>Limit joins:</strong> Joins are expensive; use watchlists when possible</li>
                    </ul>
                    
                    <h3>Before and After</h3>
                    <pre><code>// SLOW
SecurityEvent
| project *
| where Account contains "admin"
| where TimeGenerated > ago(24h)

// FAST
SecurityEvent
| where TimeGenerated > ago(24h)
| where Account has "admin"
| project TimeGenerated, Account, Computer, EventID</code></pre>
                </section>

                <section class="content-section">
                    <div class="info-box interview">
                        <div class="info-box-title">üíº Interview Tip</div>
                        <p><strong>Q: "Write a KQL query to detect potential credential theft attempts."</strong></p>
                        <p><strong>A:</strong></p>
                        <pre><code>// Detect LSASS access - common in credential theft
SecurityEvent
| where TimeGenerated > ago(24h)
| where EventID == 4663  // Object access
| where ObjectName has "lsass"
| where ProcessName !endswith "\\MsMpEng.exe"  // Exclude Defender
| where ProcessName !endswith "\\svchost.exe"  // Exclude legitimate
| summarize 
    AccessCount = count(),
    AccessingProcesses = make_set(ProcessName)
  by Computer, SubjectUserName
| extend AlertTitle = strcat("Potential LSASS Access on ", Computer)
| project TimeGenerated = now(), Computer, SubjectUserName, 
          AccessCount, AccessingProcesses, AlertTitle</code></pre>
                        <p>"This query looks for processes accessing LSASS, which is common in credential theft attacks like Mimikatz. I exclude known legitimate processes and aggregate by computer and user to surface suspicious patterns."</p>
                    </div>
                </section>

                <section class="content-section">
                    <div class="cheatsheet">
                        <div class="cheatsheet-title">üìã KQL Quick Reference</div>
                        <h4>Core Operators</h4>
                        <table>
                            <tr><th>Operator</th><th>Purpose</th><th>Example</th></tr>
                            <tr><td>where</td><td>Filter</td><td><code>where EventID == 4625</code></td></tr>
                            <tr><td>summarize</td><td>Aggregate</td><td><code>summarize count() by User</code></td></tr>
                            <tr><td>extend</td><td>Add column</td><td><code>extend Risk = "High"</code></td></tr>
                            <tr><td>project</td><td>Select columns</td><td><code>project Time, User</code></td></tr>
                            <tr><td>order by</td><td>Sort</td><td><code>order by Count desc</code></td></tr>
                            <tr><td>take</td><td>Limit</td><td><code>take 10</code></td></tr>
                            <tr><td>distinct</td><td>Unique</td><td><code>distinct User</code></td></tr>
                            <tr><td>join</td><td>Combine</td><td><code>join kind=inner (...)</code></td></tr>
                        </table>
                        <h4>Time Shortcuts</h4>
                        <p><code>ago(1h)</code>, <code>ago(24h)</code>, <code>ago(7d)</code>, <code>now()</code>, <code>startofday()</code>, <code>bin(TimeGenerated, 1h)</code></p>
                        <h4>String Operations</h4>
                        <p><code>has</code>, <code>contains</code>, <code>startswith</code>, <code>endswith</code>, <code>=~</code> (case-insensitive), <code>matches regex</code></p>
                    </div>
                </section>

                <div style="display: flex; justify-content: space-between; margin-top: var(--spacing-2xl); padding-top: var(--spacing-lg); border-top: 1px solid var(--border-default);">
                    <a href="spl-fundamentals.html" class="card-link">‚Üê SPL Fundamentals</a>
                    <a href="query-translation.html" class="card-link">Query Translation ‚Üí</a>
                </div>
            </div>
        </main>
    </div>
    <script src="main.js"></script>
</body>
</html>
